{"path":"GenAIUnleaning/General_techniques/Machine Unlearning for Image-to-Image Generative Models.pdf","text":"Published as a conference paper at ICLR 2024 MACHINE UNLEARNING FOR IMAGE-TO-IMAGE GENERATIVE MODELS Guihong Li 1‚àó, Hsiang Hsu 2, Chun-Fu (Richard) Chen 2, Radu Marculescu 1 1The University of Texas at Austin, USA 2Global Technology Applied Research, JPMorgan Chase, USA {lgh,radum}@utexas.edu {hsiang.hsu,richard.cf.chen}@jpmchase.com ABSTRACT Machine unlearning has emerged as a new paradigm to deliberately forget data samples from a given model in order to adhere to stringent regulations. However, existing machine unlearning methods have been primarily focused on classifica- tion models, leaving the landscape of unlearning for generative models relatively unexplored. This paper serves as a bridge, addressing the gap by providing a uni- fying framework of machine unlearning for image-to-image generative models. Within this framework, we propose a computationally-efficient algorithm, under- pinned by rigorous theoretical analysis, that demonstrates negligible performance degradation on the retain samples, while effectively removing the information from the forget samples. Empirical studies on two large-scale datasets, ImageNet- 1K and Places-365, further show that our algorithm does not rely on the availabil- ity of the retain samples, which further complies with data retention policy. To our best knowledge, this work is the first that represents systemic, theoretical, empir- ical explorations of machine unlearning specifically tailored for image-to-image generative models. Our code is available at https://github.com/jpmorganchase/l2l- generator-unlearning. 1 INTRODUCTION The prevalence of machine learning research and applications has sparked awareness among users, entrepreneurs, and governments, leading to new legislation1 to protect data ownership, privacy, and copyrights (Schuhmann et al., 2022; Bubeck et al., 2023; Lukas et al., 2023; Bommasani et al., 2021). At the forefront of these legislative efforts is the ‚ÄúRight to be Forgotten‚Äù, a fundamental human right that empowers individuals to request the removal of their information from online services. However, directly erasing data from databases is not enough, as it may already be ingrained in machine learning models, notably deep neural networks (DNNs), which can memorize training data effectively (Wu et al., 2017; Kuppa et al., 2021; Carlini et al., 2023). Yet another straightforward solution is to re-train DNNs from scratch on a new training dataset without the unwanted data‚Äîa resource-expensive procedure (Dhariwal & Nichol, 2021) that can not reflect users‚Äô requests in a timely manner. In response to various legal requirements and user requests, a novel approach known as machine un- learning has been proposed (Nguyen et al., 2022). This technique allows a model, which has been trained with potentially sensitive samples referred to as ‚Äúforget samples‚Äù, to selectively remove these samples without the necessity of retraining the model from scratch. Meanwhile, machine unlearning aims to minimize any adverse effects on the performance of the remaining data, termed ‚Äúretain sam- ples‚Äù. Recent unlearning algorithms have been developed, some incorporating specialized training procedures to facilitate the unlearning process (Bourtoule et al., 2021), while others adjust model weights through fine-tuning (Tarun et al., 2023a). However, these approaches primarily address un- learning in classification problems. On the other hand, generative models, which have demonstrated ‚àóWork done during internship at JPMorgan Chase Bank, N.A. 1Enactions include the General Data Protection Regulation (GDPR) by the European Union (Parliament & Council, 2016), the White House AI Bill Congress (2022b), and others (Congress, 2022a; Parliament, 2019). 1 Published as a conference paper at ICLR 2024 DiffusionModels VQ-GAN DiffusionModels VQ-GANGroundTruthInputBeforeUnlearningAfterUnlearningGroundTruthInputBeforeUnlearningAfterUnlearning (a) Retain Set DiffusionModels VQ-GAN DiffusionModels VQ-GANGroundTruthInputBeforeUnlearningAfterUnlearningGroundTruthInputBeforeUnlearningAfterUnlearning (b) Forget Set Figure 1: Our machine unlearning framework is applicable to various types of I2I generative models, including the diffusion models (Saharia et al., 2022a), VQ-GAN (Li et al., 2023) and MAE (He et al., 2022) (cf. Section 4). The images in the retain set remain almost (up to a slight difference due to the perplexity of generative models) unaffected before and after unlearning. Conversely, the images in the forget set are nearly noise after unlearning, as designed. superior data memorization capabilities compared to classification models (Tirumala et al., 2022; Somepalli et al., 2023), excel at regenerating training samples (Kuppa et al., 2021; Carlini et al., 2023). Therefore, the challenge of ensuring effective unlearning for generative models has become increasingly important and pressing. In this paper, our emphasis lies on a particular category of generative model architectures known as Image-to-Image (I2I) generative models (Yang et al., 2022). This selection offers a twofold advantage: First, it paves the way for a groundbreaking approach to quantify the efficacy of machine unlearning for generative models‚Äîa research direction hitherto uncharted in existing literature. Informally speaking, we define a generative model as having ‚Äútruly unlearned‚Äù an image when it is unable to faithfully reconstruct the original image when provided with only partial information (see Figure 1 for an illustrative example where the partial information involves center cropping 2). Second, I2I generative models encompass all major branches in the field of vision generative models, including Masked Autoencoder (MAE) (He et al., 2022), Vector Quantized Generative Adversarial Networks (VQ-GAN) (Li et al., 2023), and the more recent diffusion probabilistic models (Ho et al., 2020). Based on this novel definition to quantify unlearning, our contributions can be summarized as follows: ‚Ä¢ We formulate a machine unlearning framework for I2I generative models that is applicable to MAE, VQ-GAN and diffusion models. This formulation, in essence, is an unbounded optimization problem. We provide theoretical derivations that guarantee the unique opti- mality of its bounded counterpart, and design an algorithm for the efficient computation. ‚Ä¢ We conduct extensive evaluations of our algorithm on various I2I generative models, in- cluding MAE, VQ-GAN and diffusion models. Empirical results on two large scale datasets, ImageNet-1K (Deng et al., 2009) and Places-365 (Zhou et al., 2017), show that our framework exhibits negligible performance degradation on retain sets, meanwhile ef- fectively eliminating the information in forget sets. ‚Ä¢ We further illustrate that the availability of the exact retain set is not necessary in our framework‚Äîthe efficacy of our algorithm remains intact even without any samples from the exact retain set. 2For the precise definition, see Section 3. 2 Published as a conference paper at ICLR 2024 To the best of our knowledge, this work is the first that systemically, theoretically, empirically ex- plore the machine unlearning specifically targeting for I2I generative models. Proofs, details on experimental setups and training, and additional results are included in the Appendix. 2 RELATED WORK I2I generative models. Many computer vision tasks can be formulated as I2I generation pro- cesses, such as image super-resolution (Bulat et al., 2018), style transfer (Zhu et al., 2017), image extension (Chang et al., 2022) and inpainting (Krishnan et al., 2019). Different type of I2I generative models utilize diverse training and optimization strategies to minimize the discrepancy between their generated images and the ground truth images. The broadly used Generative Adversarial Networks (GANs) are trained by reducing a discriminator‚Äôs accuracy in determining whether a generated im- age is real or synthetic (Goodfellow et al., 2014; Karras et al., 2019; Chen et al., 2016; Karras et al., 2020). However, stabilizing the training of GANs is a well-known challenge (Arjovsky et al., 2017; Gulrajani et al., 2017; Brock et al., 2019). In contrast, diffusion models address the stability issue by utilizing a multi-step generation strategy and are optimized by minimizing the Kullback‚ÄìLeibler (KL) divergence between the distributions of the generated and ground truth images (Ho et al., 2020; Song & Ermon, 2020; Hoogeboom et al., 2022; Salimans & Ho, 2022). Diffusion models can gen- erate higher-fidelity images than GANs but require much longer generation time (Saharia et al., 2022b; Rombach et al., 2022; Zhang & Agrawala, 2023). Recently, Masked Autoencoder (MAE) has been proposed as a multi-purpose model for both image generation and classification (He et al., 2022; Feichtenhofer et al., 2022; Tong et al., 2022). Typically, MAE is optimized by minimizing the MSE loss between the generated and ground truth images. In this paper, our goal is to design a universal approach that is capable of conducting unlearning across diverse I2I model types with different optimization techniques. Machine unlearning. Machine unlearning allows a trained model to selectively remove some unwanted samples (‚Äúforget set‚Äù) while minimizing any adverse effects on the performance of the remaining data (‚Äúretain set‚Äù) and without retraining the model from scratch (Xu et al., 2023). As the pioneering work on unlearning, SISA facilitates the unlearning of specific samples by retraining the model checkpoints that were initially trained with these ‚Äùforget‚Äù samples (Bourtoule et al., 2021). However, SISA needs to re-train all these models from scratch, if the forget samples are distributed across all shards. To address this problem, several methods manipulate the trained model weights directly. Some works compute the Neural Tangent Kernel (NTK) to modify model weights, but the computation of the Hessian matrix in NTK‚Äôs calculation is numerically unstable and not scalable for models with many parameters (Golatkar et al., 2020a;b). Graves et al. (2021) requires the storage of the gradient for each parameter of every training step when training the original models. This approach is not scalable given the extremely large training set and the enormous model size for the latest image generative models. Other methods improve the efficiency by maximizing loss on the forget set or re-assigning incorrect labels but typically they are only applicable to classification tasks. (Neel et al., 2021; Tarun et al., 2023b; Chourasia & Shah, 2023; Kurmanji et al., 2023; Chen et al., 2023). There are also some approaches focusing on other perspectives of unlearning instead of designing new unlearning algorithms. For example, Chundawat et al. (2023) focuses on the data access issues of existing unlearning algorithms and suggests using the images generated by the original model as the alternative for the original training set. Besides, Jia et al. (2023) shows that that pruning the original model before unlearning can improve the overall performance of many existing unlearning algorithms. Previous unlearning approaches primarily focus on classification tasks, but there are emerging efforts on generative models. For instance, several methods maximize training loss on the forget set, but are validated only on tiny datasets, like MNIST (Bae et al., 2023; Sun et al., 2023). Other works focus on unlearning specific features (e.g., eye color, hairstyle) from generated images, but are only verified under small-scale setups and lack comprehensive analysis (Kong & Chaudhuri, 2023; Moon et al., 2023). Besides, these methods typically manipulate the entire model, thus requiring extensive computation capacity due to the growing complexity and size of generative models. Moreover, none of them addresses I2I generative tasks. This motivates us to explore the efficient unlearning algorithms for I2I generative models in large-scale setups. 3 Published as a conference paper at ICLR 2024 3 PROBLEM FORMULATION AND PROPOSED APPROACH In this work, we primarily address the machine unlearning for I2I generative models that reconstruct images from incomplete or partial inputs. Typically, I2I generative models adopt an encoder-decoder network architecture, comprising two components, namely, (i) an encoder network EŒ∏ that encodes an input into a representation vector and (ii) a decoder network Dœï that decodes the representation vector into the image. Specifically, given an input x, the output for an I2I generative model hŒ∏,œï is as follows: hŒ∏,œï = Dœï ‚ó¶ EŒ∏, hŒ∏,œï (T (x)) = Dœï (EŒ∏ (T (x))) (1) where x is a ground truth image; T (¬∑) is the operation to remove some information from x, e.g., center cropping and random masking; ‚ó¶ is the composition operator; Œ∏ and œï are the parameters for the encoder and decoder, respectively. 3.1 DEFINITION OF UNLEARNING ON I2I GENERATIVE MODELS For machine unlearning on I2I generative models, given a trained model (i.e., original model) hŒ∏0,œï0 = Dœï0 ‚ó¶ EŒ∏0 with parameters Œ∏0 and œï0, the unlearning algorithm AF aims to obtain a target model: hŒ∏,œï ‚âú AF (hŒ∏0,œï0) that satisfies the following properties: ‚Ä¢ On the retain set DR, hŒ∏,œï generates images that have the same distribution as the original model; ‚Ä¢ On the forget set DF , hŒ∏,œï generates images that have far different distribution from the original model. By using the KL-divergence (D), from a probability distribution perspective, these objectives are as follows: arg min Œ∏,œï D (PhŒ∏0,œï0 (T (Xr))||PhŒ∏,œï(T (Xr))) , and arg max Œ∏,œï D (PhŒ∏0,œï0 (T (Xf ))||PhŒ∏,œï(T (Xf ))) (2) where, Xr and Xf are random variables that account for the ground truth images of the retain and forget sets, respectively. By combining these two objectives, we formulate our optimization goal as follows: arg min Œ∏,œï {D ( PhŒ∏0,œï0 (T (Xr))||PhŒ∏,œï(T (Xr))) ‚àí Œ±D (PhŒ∏0,œï0 (T (Xf ))||PhŒ∏,œï(T (Xf ))) } (3) where Œ± is a positive coefficient to control the trade-off between the retain and forget sets. Multiple previous works assume a trained I2I generative model can do an almost perfect generation on both of the retain and forget sets (Wallace et al., 2023; Song et al., 2023; Xia et al., 2023; Kingma & Welling, 2019); that is, hŒ∏0,œï0 (T (X)) ‚âà X. Therefore, Eq. (3) can be rewritten as: arg min Œ∏,œï { D ( PXr ||P ÀÜXr ) ‚àí Œ±D (PXf ||P ÀÜXf ) }, ÀÜXr = hŒ∏,œï (T (Xr)) , ÀÜXf = hŒ∏,œï (T (Xf )) (4) where PXr and P ÀÜXr represent the distribution of ground truth images and generated images in the retain set; PXf and P ÀÜXf represent the distribution of ground truth images and generated images in the forget set. 3.2 OPTIMIZATION ON RETAIN AND FORGET SETS Clearly, for the first term in Eq. (4), a perfect unlearned model has no performance degradation on the retains set. In other words, the generated images share the distribution as ground truth images, i.e., P ÀÜXr = PXr . This way, the value of D (PXr ||P ÀÜXr ) is 0. Next, we discuss the optimization for the forget set. 4 Published as a conference paper at ICLR 2024 To minimize the value for the objective functions in Eq. (4), we need to maximize KL divergence be- tween PXf and P ÀÜXf . However, there are infinitely many probability distributions that have infinity KL divergence with PXf (see Appendix A for more details). The ‚àû value for the KL divergence will lead to unbounded loss values thus hurting the stability of the unlearning process. To address this problem, we derive an optimal and bounded KL divergence for the forget set under some reasonable constraints: Lemma 1 Given the distribution of the forget samples PXf with zero-mean and covariance matrix Œ£, consider another signal P ÀÜXf which shares the same mean and covariance matrix. The maximal KL-divergence between PXf and P ÀÜXf is achieved when P ÀÜXf = N (0, Œ£) (Cover & Thomas, 2012); that is: D (PXf ||P ÀÜXf ) ‚â§ D (PXf ||N (0, Œ£)) (5) We note that making P ÀÜXf share the same mean and covariance matrix as PXf can preserve the original training set statistical patterns. Consequently, it becomes statistically challenging to decide whether a generated image belongs to the forget set, thereby protecting data privacy. Moreover, the assumption of zero mean is natural since typically images are normalized by subtracting the mean value inside neural networks. We provide some empirical analysis to demonstrate the benefits of Gaussian distribution (cf. Section 4.4). Essentially, Lemma 1 indicates that the maximal KL divergence w.r.t PXf is achieved when the generated images P ÀÜXf follow the Gaussian distribution N (0, Œ£). Hence, we can directly optimize P ÀÜXf towards this optimal solution by minimizing their KL-Divergence; that is: arg min Œ∏,œï { D (PXr ||P ÀÜXr ) + Œ±D (N (0, Œ£) ||P ÀÜXf ) }, ÀÜXr = hŒ∏,œï (T (Xr)) , ÀÜXf = hŒ∏,œï (T (Xf )) (6) This way, we avoid the problem of the infinity value of KL-divergence in Eq. (4). We note that, for previous unlearning approaches for classification tasks, it‚Äôs natural and straightforward to directly compute the KL-divergence for final outputs since the outputs are exactly single-variable discrete distributions after the SoftMax function (Zhang et al., 2023a;b; Kurmanji et al., 2023). Neverthe- less, for image generation tasks, directly computing the KL divergence between high-dimensional output images is typically intractable, excluding the special case of diffusion models. To address this problem, we next convert the KL divergence into a more efficient L2 loss which is generally applicable to diverse I2I generative models. 3.3 PROPOSED APPROACH Directly connecting the KL-Divergence with the L2 loss is difficult. Instead, we use Mutual Infor- mation (MI) as a bridge to help with the analysis. As indicated in Eq. (6), we reach the minimal objective value when P ÀÜXr = PXr and P ÀÜXf = N (0, Œ£). This optimum can also be achieved by maximizing the mutual information (I) between Xr and ÀÜXr (or between n ‚àº N (0, Œ£) and ÀÜXf ); that is: arg max Œ∏,œï { I (Xr; ÀÜXr)+Œ±I (n; ÀÜXf ) }, n ‚àº N (0, Œ£), ÀÜXr = hŒ∏,œï (T (Xr)) , ÀÜXf = hŒ∏,œï (T (Xf )) (7) We next link the MI with a more tractable L2 loss in the representation space. Theorem 1 Suppose the original model can do a perfect generation, i.e., hŒ∏0,œï0 (T (X)) = X. Assume the target model hŒ∏,œï uses the same decoder as the original model hŒ∏0,œï0 (i.e., Dœï = Dœï0), and the output of the encoders is normalized, i.e., ‚à•EŒ∏(x)‚à•2 = ‚à•EŒ∏0 (x)‚à•2 = 1. On the retain set, minimizing the L2 loss between the output of the target model encoder EŒ∏ and the original model encoder EŒ∏0 will increase the lower bound of mutual information: I(Xr; ÀÜXr) ‚â• log (K) ‚àí E Ô£Æ Ô£∞ K‚àë i=1 1 K log Ô£´ Ô£≠e œµ2 i 2 ‚àí1 K‚àë j=1 eœµj +Rij Ô£∂ Ô£∏ Ô£π Ô£ª (8) 5 Published as a conference paper at ICLR 2024ForgetsetRetainsetOriginalmodel(Fixed)Targetmodel(Learnable)Encoder ùê∏ùê∑ùê∑Encoder ùê∏ùë•ùë•ùëõ‚àºùí©0,ùõ¥ùêøùê∏ùíØùë•ùê∏ùíØùëõùêøùê∏ùíØùë•ùê∏ùíØùë• Figure 2: Overview of our approach. On DF , we minimize the L2-loss between embedding vectors of the forget samples xf and embedding vectors of Gaussian noise n. On DR, we minimize the L2- loss between the same image embedding vectors generated by target model encoder and the original model encoder. where œµi = ‚à•EŒ∏ (T (xri)) ‚àí EŒ∏0 (T (xri)) ‚à•2 and Rij = EŒ∏0 (T (xri))T EŒ∏0(T (xrj )). xri are the data samples in the retain set. For the forget set, we have: I(n; ÀÜXf ) ‚â• log (K) ‚àí E Ô£Æ Ô£∞ K‚àë i=1 1 K log Ô£´ Ô£≠e Œ¥2 i 2 ‚àí1 K‚àë j=1 eŒ¥j +Fij Ô£∂ Ô£∏ Ô£π Ô£ª , n ‚àº N (0, Œ£) (9) where Œ¥i = ‚à•EŒ∏ (T (xfi)) ‚àí EŒ∏0 (T (ni)) ‚à•2 and Fij = EŒ∏0(T (ni))T EŒ∏0(T (nj)). xf i are the data samples in the forget set and ni ‚àº N (0, Œ£). We remark that both Rij and Fij are determined by the original encoder EŒ∏0, thus are fixed values. As illustrated in Theorem 1, by directly reducing the L2 loss (Œ¥i and œµi) between the target encoder and the original encoder, the Mutual Information (MI) increases, concurrently reducing the KL divergence between PXr and P ÀÜXf (or between P ÀÜXf and N ). Hence, in our approach, we sidestep the intractability of computing MI or KL divergence by directly minimizing the values of Œ¥i and œµi. Based on these insights, we next introduce our approach. Efficient Unlearning Approach. Finally, as shown in Fig. 2, we propose our efficient unlearning approach for I2I generative models as follows: AF (hŒ∏0,œï0 ) ‚âú arg min Œ∏ E xri ,xfj ,n {‚à£ ‚à£EŒ∏ ( T (xri )) ‚àí EŒ∏0 ( T (xri ) ) ‚à£ ‚à£ 2 + Œ± ‚à£ ‚à£EŒ∏ (T (xfj ) ) ‚àí EŒ∏0 (T (n)) ‚à£ ‚à£ 2 } xri ‚àà DR, xfj ‚àà DF , n ‚àº N (0, Œ£) (10) We provide the details of our unlearning algorithm and corresponding pseudo code in Appendix C.4. We note that our proposed approach only involves the encoders. Hence, it‚Äôs more efficient than ma- nipulating the entire model. Moreover, our approach is generally applicable to various I2I generative models with the encoder-decoder architecture (including the diffusion model, VQ-GAN, or MAE), although they typically use different optimization methods. We illustrate this generalizability in the experiments part. 4 EXPERIMENTAL RESULTS We evaluate our proposed approach on three mainstream I2I generative models: (i) diffusion mod- els (Saharia et al., 2022a), (ii) VQ-GAN (Li et al., 2023), and (iii) MAE (He et al., 2022). 4.1 EXPERIMENTAL SETUP Dataset&Task. We verify our method on two mainstream large-scale datasets: (i) ImageNet-1k. Out of total 1K classes, we randomly select 100 classes as DR and another 100 classes as DF . (ii) 6 Published as a conference paper at ICLR 2024 Table 1: Results of cropping 8 √ó 8 patches at the center of the image, where each patch is 16 √ó 16 pixels. ‚Äò‚Üë‚Äô means higher is better and ‚Äò‚Üì‚Äô means lower is better. R and F account for the retain set and forget set, respectively.‚ÄòProxy DR‚Äô means that we use the images from other classes as a substitute of the real retain set to do the unlearning (cf. Section 4.3). Diffusion Models VQ-GAN MAE FID IS CLIP FID IS CLIP FID IS CLIP R‚Üì F ‚Üë R‚Üë F ‚Üì R‚Üë F ‚Üì R‚Üì F ‚Üë R‚Üë F ‚Üì R‚Üë F ‚Üì R‚Üì F ‚Üë R‚Üë F ‚Üì R‚Üë F ‚Üì Original model 12.2 14.6 19.3 23.1 0.88 0.89 14.4 14.4 19.4 20.6 0.75 0.77 56.7 84.1 23.0 17.4 0.73 0.71 MAX LOSS 34.1 45.7 12.8 17.1 0.77 0.76 16.9 115.2 17.4 11.0 0.73 0.55 75.8 112.6 19.4 15.2 0.69 0.65 NOISY LABEL 14.7 36.9 19.3 19.1 0.86 0.80 14.8 79.5 17.2 11.4 0.74 0.64 60.4 136.5 21.6 12.8 0.71 0.67 RETAIN LABEL 23.1 104.7 18.2 12.3 0.81 0.69 21.8 23.3 18.2 18.3 0.72 0.74 72.8 145.3 18.8 11.6 0.69 0.66 RANDOM ENCODER 15.3 30.6 18.7 19.4 0.86 0.81 14.7 72.8 18.6 14.1 0.74 0.64 58.1 146.4 22.3 12.8 0.72 0.67 Ours 13.4 107.9 19.4 10.3 0.87 0.69 15.0 83.4 18.3 11.6 0.74 0.60 59.9 153.0 21.8 11.0 0.72 0.67 Ours (Proxy DR) 17.9 75.5 18.2 12.3 0.83 0.74 17.6 69.7 18.6 14.0 0.73 0.63 61.1 133.8 21.0 12.3 0.72 0.68 Table 2: Results of cropping 4 √ó 4 patches at the center of the image, where each patch is 16 √ó 16 pixels. ‚Äò‚Üë‚Äô means higher is better and ‚Äò‚Üì‚Äô means lower is better. R and F account for the retain set and forget set, respectively. ‚ÄúProxy DR‚Äù means that we use the images from other classes as a substitute of the real retain set to do the unlearning (cf. Section 4.3). Diffusion Models VQ-GAN MAE FID IS CLIP FID IS CLIP FID IS CLIP R‚Üì F ‚Üë R‚Üë F ‚Üì R‚Üë F ‚Üì R‚Üì F ‚Üë R‚Üë F ‚Üì R‚Üë F ‚Üì R‚Üì F ‚Üë R‚Üë F ‚Üì R‚Üë F ‚Üì Original model 7.8 6.0 10.3 11.2 0.93 0.96 8.4 7.8 15.1 14.2 0.84 0.85 11.4 15.8 50.8 46.6 0.87 0.87 MAX LOSS 11.9 15.4 10.0 11.0 0.88 0.93 9.2 39.9 15.2 13.1 0.83 0.72 13.3 20.2 50.8 46.0 0.86 0.83 NOISY LABEL 19.6 18.5 10.4 10.6 0.87 0.91 8.7 21.3 15.2 14.1 0.84 0.80 12.2 44.3 50.0 35.4 0.86 0.82 RETAIN LABEL 8.5 35.1 10.3 10.5 0.93 0.89 11.0 10.3 15.4 14.2 0.83 0.84 15.3 47.5 47.6 34.9 0.85 0.81 RANDOM ENCODER 15.3 11.6 10.1 11.1 0.86 0.94 8.6 19.4 15.3 14.4 0.84 0.81 11.8 43.6 50.3 36.3 0.86 0.83 Ours 8.2 39.8 10.3 10.7 0.93 0.88 8.6 22.0 15.0 14.1 0.84 0.79 12.2 45.1 49.7 34.8 0.86 0.83 Ours (Proxy DR) 11.2 29.0 10.3 10.8 0.91 0.9 8.9 20.0 15.4 14.3 0.84 0.80 12.5 39.9 49.5 36.8 0.86 0.83 Places-365. From all 365 classes, we randomly select 50 classes as DR and another 50 classes as DF . We test our method on image extension, uncropping, and reconstruction tasks. We report the results of center uncropping (i.e., inpainting) in the main paper. The results of other tasks are given in Appendix D and E.1. Baseline. We first report the performance of the original model (i.e., before unlearning) as the reference. Since our approach is the first work that does the unlearning for I2I generative models, there are no previous baselines we can directly compare against. Therefore, we implement three different unlearning approaches that were designed for other tasks, and adapt them to I2I generative models, including (i) MAX LOSS maximizes the training loss w.r.t. the ground truth images on the forget set (Halimi et al., 2022; Gandikota et al., 2023; Warnecke et al., 2023); (ii) NOISY LABEL minimizes training loss by setting the Gaussian noise as the ground truth images for the forget set (Graves et al., 2021; Gandikota et al., 2023); (iii) RETAIN LABEL minimizes training loss by setting the retain samples as the ground truth for the forget set (Kong & Chaudhuri, 2023); (iv) RANDOM ENCODER directly minimizes the L2 loss between the encoder‚Äôs output on the forget set and a Gaussian noise (Tarun et al., 2023b). For all these baselines, we use the retain samples with some regularization to avoid hurting the performance on the retain set. For more details, please check Appendix C.6. Evaluation metrics. We adopt three different types of metrics to compare our method against other baselines: (i) inception score (IS) of the generated images (Salimans et al., 2016), (ii) Fr¬¥echet inception distance (FID) against the real images (Heusel et al., 2017) and (iii) CLIP embedding distance between the generated images and the real images (Radford et al., 2021). IS assesses the quality of the generated images alone, while FID further measure the similarity between generated and real images. On the other hand, the CLIP embedding distance measures whether or not the generated images still capture similar semantics. 4.2 PERFORMANCE ANALYSIS AND VISUALIZATION As shown in Table 1 and Table 2, compared to the original model, our approach has almost identical performance or only a slight degradation on the retain set. Meanwhile, there are significant perfor- 7 Published as a conference paper at ICLR 2024 Forget SetRetain SetGround TruthInput Original ModelMAX LOSSNOISY LABELRETAIN LABELRANDOM ENCODEROurs Figure 3: Results of cropping 8 √ó 8 patches at the center of the image on diffusion models, where each patch is 16√ó16 pixels. Our method has negligible-to-slight performance degradation on diverse I2I generative models and multiple generative tasks. (cf. Appendix D and E.1). 30 20 10 0 10 20 30 20 10 0 10 20 30 (a) Diffusion Models 30 20 10 0 10 20 30 30 20 10 0 10 20 (b) VQ-GAN 30 20 10 0 10 20 30 30 20 10 0 10 20 30 (c) MAE 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0 Unlearn: Forget Set Unlearn: Retain Set Ground Truth: Forget Set Ground Truth: Retain Set Figure 4: T-SNE analysis of the generated images by our approach and ground truth images. After unlearning, the generated retain samples are close to or overlapping with the ground truth (orange vs. blue), while most of generated forget images diverge far from the ground truth (green vs. red). mance drops on the forget set across all these three models for all metrics. In contrast, none of these baselines generally works well. For example, RANDOM ENCODER achieves similar performance on VQ-GAN and MAE to our methods; however, it is much worse on diffusion models. Similarly, RETAIN LABEL works well for diffusion models, but cannot generalize to VQ-GAN and MAE. We also show some generated images in Fig. 3. As shown, our approach removes the information in the forget set while preserving the performance on the retain set. T-SNE analysis. To further analyze why our approach works well, we conduct the T-SNE analysis. Using our unlearned model, we generate 50 images for both the retain and forget sets. We then compute the CLIP embedding vector of these images and their corresponding ground truth images. As shown in Fig. 4, after unlearning, the CLIP embedding vector on the retain set is close to or overlapping with the ground truth images, while most of generated images on the forget set diverge far from the ground truth. These results verify that our method is generally applicable to mainstream I2I generative models and consistently achieves good results on all these models. We provide more results under various types of cropping in Appendix D and Appendix E. 4.3 ROBUSTNESS TO RETAIN SAMPLES AVAILABILITY In machine unlearning, sometimes the real retain samples are not available due to data retention policies. To address this challenge, we evaluate our approach by using other classes of images as substitute to the real retain samples. On ImageNet-1K, since we already select 200 classes for forget and retain sets, we randomly select some images from the remaining 800 classes as the ‚Äúproxy retain set‚Äù used in the unlearning process. Similarly, for Places-365, we randomly select some images from the remaining 265 classes as the ‚Äúproxy retain set‚Äù used in the unlearning process. We also ensure these ‚Äúproxy retain sets‚Äù have the same number of images as the forget set. As shown in the last row in Table 1 and Table 2, our method works well even without the access to the real/original retain set. Compared to using the real/original retain set, there is only a slight performance drop. Hence, our approach is flexible and generally applicable without the dependency 8 Published as a conference paper at ICLR 2024 Table 3: Ablation study of Œ±‚Äôs values. We test the performance of cropping 8 √ó 8 patches at the center of the image. As shown, Œ± = 0.25 achieves a good balance between the preserving the performance on retain set, while remove the information on forget sets across these two models. VQ-GAN MAE Œ± 0.01 0.05 0.1 0.2 0.25 0.5 1 0.01 0.05 0.1 0.2 0.25 0.5 1 FID R‚Üì 90.8 91.6 92.0 91.7 92.7 92.2 94.7 113.6 113.2 113.9 116.7 115.9 116.3 116.7 F ‚Üë 101.2 169.4 179.5 181.3 183.4 182.2 184.6 179.0 198.6 205.1 211.5 213.0 213.4 213.0 IS R‚Üë 12.5 12.8 12.5 12.4 12.2 12.0 12.6 13.3 13.3 13.4 13.5 13.2 13.3 12.9 F ‚Üì 11.5 8.4 7.8 7.9 8.1 7.9 8.0 9.3 9.0 8.5 8.0 8.0 8.1 7.9 CLIP R‚Üë 0.65 0.65 0.65 0.65 0.65 0.65 0.64 0.81 0.81 0.81 0.80 0.80 0.80 0.80 F ‚Üì 0.66 0.55 0.54 0.54 0.54 0.54 0.54 0.79 0.78 0.78 0.78 0.78 0.78 0.78 on the real retain samples. We provide the results with limited availability to the real retain samples in Appendix D.1. 4.4 ABLATION STUDY For the ablation study, we test the results of cropping patches at the center of the image under various setups, where each patch is 16 √ó 16 pixels. Œ±‚Äôs value. We vary the value of Œ± in Eq. (10) to obtain multiple models and then evaluate their performance. As shown in Table 3, when Œ± is 0.25, our approach achieves a good balance between the forget set and the retain set. Hence, we set Œ± = 0.25 as default value for our approach. We provide more ablation study in Appendix E. 5 CONCLUSIONS AND FINAL REMARKS In this paper, we have formulated the machine unlearning problem for I2I generative models and derived an efficient algorithm that is applicable across various I2I generative models, including diffusion models, VQ-GAN, and MAE. Our method has shown negligible performance degradation on the retain set, while effectively removing the information from the forget set, on two large-scale datasets (ImageNet-1K and Places-365). Remarkably, our approach is still effective with limited or no real retain samples. To our best knowledge, we are the first to systematically explore machine unlearning for image completion generative models. Limitations. First, our methods are mainly verified on I2I generative models. Second, our ap- proach requires the access of original/real forget samples yet sometimes they are unavailable. Be- sides, for the simplicity of evaluation, we only test our approach on some mainstream computer vision datasets. Our approach has not been verified under a more practical/useful scenarios, e.g., remove the pornographic information for I2I generative models. Future directions. We plan to explore applicability to other modality, especially for language/text generation and text-to-image generation. The dependency on the forget set is another challenge that enable flexibility in the unlearning for generative models. Finally, we also intend to develop some more practical benchmarks related to the control of generative contents and protect the data privacy and copyright. DISCLAIMER This paper was prepared for informational purposes by the Global Technology Applied Research center of JP- Morgan Chase & Co. This paper is not a product of the Research Department of JPMorgan Chase & Co. or its affiliates. Neither JPMorgan Chase & Co. nor any of its affiliates makes any explicit or implied representation or warranty and none of them accept any liability in connection with this paper, including, without limitation, with respect to the completeness, accuracy, or reliability of the information contained herein and the potential legal, compliance, tax, or accounting effects thereof. This document is not intended as investment research or investment advice, or as a recommendation, offer, or solicitation for the purchase or sale of any security, financial instrument, financial product or service, or to be used in any way for evaluating the merits of partic- ipating in any transaction. Guihong Li‚Äôs and Radu Marculescu‚Äôs contributions were made as part of Guihong Li‚Äôs internship at the Global Technology Applied Research center of JPMorgan Chase & Co. 9 Published as a conference paper at ICLR 2024 Ethics statement. Machine unlearning for I2I generative models can be effectively exploited to avoid generate contents related user privacy and copyright. Moreover, unlearning for I2I models can avoid generating harmful contents, such as violence or pornography. Reproducibility statement. All the datasets used in this paper are open dataset and are available to the public. Besides, our codes are primarily based on PyTorch (Paszke et al., 2019). We use several open source code base and model checkpoints to build our own approach (see Appendix C.1). Our approach can be implemented by obtaining the outputs of target model‚Äôs encoders and the original model‚Äôs encoders and then computing the L2-loss between them. We provide more implementation details in Appendix C. REFERENCES Mart¬¥ƒ±n Arjovsky, Soumith Chintala, and L¬¥eon Bottou. Wasserstein generative adversarial networks. In Inter- national Conference on Machine Learning, pp. 214‚Äì223. PMLR, 2017. Seohui Bae, Seoyoon Kim, Hyemin Jung, and Woohyung Lim. Gradient surgery for one-shot unlearning on generative model. CoRR, abs/2307.04550, 2023. Mohamed Ishmael Belghazi, Aristide Baratin, Sai Rajeshwar, Sherjil Ozair, Yoshua Bengio, Aaron Courville, and Devon Hjelm. Mutual information neural estimation. In International Conference on Machine Learning, pp. 531‚Äì540. PMLR, 2018. Rishi Bommasani, Drew A. Hudson, Ehsan Adeli, Russ B. Altman, Simran Arora, Sydney von Arx, Michael S. Bernstein, Jeannette Bohg, Antoine Bosselut, Emma Brunskill, Erik Brynjolfsson, Shyamal Buch, Dallas Card, Rodrigo Castellon, Niladri S. Chatterji, Annie S. Chen, Kathleen Creel, Jared Quincy Davis, Dorottya Demszky, Chris Donahue, Moussa Doumbouya, Esin Durmus, Stefano Ermon, John Etchemendy, Kawin Ethayarajh, Li Fei-Fei, Chelsea Finn, Trevor Gale, Lauren Gillespie, Karan Goel, Noah D. Goodman, Shelby Grossman, Neel Guha, Tatsunori Hashimoto, Peter Henderson, John Hewitt, Daniel E. Ho, Jenny Hong, Kyle Hsu, Jing Huang, Thomas Icard, Saahil Jain, Dan Jurafsky, Pratyusha Kalluri, Siddharth Karamcheti, Geoff Keeling, Fereshte Khani, Omar Khattab, Pang Wei Koh, Mark S. Krass, Ranjay Krishna, Rohith Kuditipudi, and et al. On the opportunities and risks of foundation models. CoRR, abs/2108.07258, 2021. Lucas Bourtoule, Varun Chandrasekaran, Christopher A. Choquette-Choo, Hengrui Jia, Adelin Travers, Baiwu Zhang, David Lie, and Nicolas Papernot. Machine unlearning. In 42nd IEEE Symposium on Security and Privacy, SP 2021, San Francisco, CA, USA, 24-27 May 2021, pp. 141‚Äì159. IEEE, 2021. Andrew Brock, Jeff Donahue, and Karen Simonyan. Large scale GAN training for high fidelity natural image synthesis. In 7th International Conference on Learning Representations, ICLR 2019, New Orleans, LA, USA, May 6-9, 2019. OpenReview.net, 2019. S¬¥ebastien Bubeck, Varun Chandrasekaran, Ronen Eldan, Johannes Gehrke, Eric Horvitz, Ece Kamar, Peter Lee, Yin Tat Lee, Yuanzhi Li, Scott M. Lundberg, Harsha Nori, Hamid Palangi, Marco T¬¥ulio Ribeiro, and Yi Zhang. Sparks of artificial general intelligence: Early experiments with GPT-4. CoRR, abs/2303.12712, 2023. Adrian Bulat, Jing Yang, and Georgios Tzimiropoulos. To learn image super-resolution, use a gan to learn how to do image degradation first. In Proceedings of the European Conference on Computer Vision (ECCV), pp. 185‚Äì200, 2018. Nicolas Carlini, Jamie Hayes, Milad Nasr, Matthew Jagielski, Vikash Sehwag, Florian Tramer, Borja Balle, Daphne Ippolito, and Eric Wallace. Extracting training data from diffusion models. In 32nd USENIX Security Symposium (USENIX Security 23), pp. 5253‚Äì5270, 2023. Huiwen Chang, Han Zhang, Lu Jiang, Ce Liu, and William T. Freeman. Maskgit: Masked generative image transformer. In IEEE/CVF Conference on Computer Vision and Pattern Recognition, CVPR 2022, New Orleans, LA, USA, June 18-24, 2022, pp. 11305‚Äì11315. IEEE, 2022. Min Chen, Weizhuo Gao, Gaoyang Liu, Kai Peng, and Chen Wang. Boundary unlearning: Rapid forgetting of deep networks via shifting the decision boundary. In IEEE/CVF Conference on Computer Vision and Pattern Recognition, CVPR 2023, Vancouver, BC, Canada, June 17-24, 2023, pp. 7766‚Äì7775. IEEE, 2023. Xi Chen, Yan Duan, Rein Houthooft, John Schulman, Ilya Sutskever, and Pieter Abbeel. Infogan: Interpretable representation learning by information maximizing generative adversarial nets. In Advances in Neural In- formation Processing Systems, pp. 2172‚Äì2180, 2016. Rishav Chourasia and Neil Shah. Forget unlearning: Towards true data-deletion in machine learning. In Andreas Krause, Emma Brunskill, Kyunghyun Cho, Barbara Engelhardt, Sivan Sabato, and Jonathan Scarlett (eds.), International Conference on Machine Learning, volume 202 of Proceedings of Machine Learning Research, pp. 6028‚Äì6073. PMLR, 2023. 10 Published as a conference paper at ICLR 2024 Vikram S. Chundawat, Ayush K. Tarun, Murari Mandal, and Mohan S. Kankanhalli. Zero-shot machine un- learning. IEEE Trans. Inf. Forensics Secur., 18:2345‚Äì2354, 2023. Japan Congress. Act on the protection of personal information, 2022a. URL https://www.ppc.go.jp/ files/pdf/280222_amendedlaw.pdf. United States Congress. American data privacy and protection act, 2022b. URL https://www.congress. gov/bill/117th-congress/house-bill/8152. T.M. Cover and J.A. Thomas. Elements of Information Theory, chapter 12, pp. 409‚Äì413. Wiley, 2012. ISBN 9781118585771. Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei. Imagenet: A large-scale hierarchical image database. In 2009 IEEE Computer Society Conference on Computer Vision and Pattern Recognition (CVPR 2009), 20-25 June 2009, Miami, Florida, USA, pp. 248‚Äì255. IEEE Computer Society, 2009. Prafulla Dhariwal and Alexander Quinn Nichol. Diffusion models beat gans on image synthesis. In Advances in Neural Information Processing Systems, pp. 8780‚Äì8794, 2021. Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Un- terthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, Jakob Uszkoreit, and Neil Houlsby. An image is worth 16x16 words: Transformers for image recognition at scale. In 9th Interna- tional Conference on Learning Representations, ICLR 2021, Virtual Event, Austria, May 3-7, 2021. Open- Review.net, 2021. Christoph Feichtenhofer, Yanghao Li, Kaiming He, et al. Masked autoencoders as spatiotemporal learners. In Advances in Neural Information Processing Systems, volume 35, pp. 35946‚Äì35958, 2022. Rohit Gandikota, Joanna Materzynska, Jaden Fiotto-Kaufman, and David Bau. Erasing concepts from diffusion models. CoRR, abs/2303.07345, 2023. Aditya Golatkar, Alessandro Achille, and Stefano Soatto. Eternal sunshine of the spotless net: Selective forget- ting in deep networks. In 2020 IEEE/CVF Conference on Computer Vision and Pattern Recognition, CVPR 2020, Seattle, WA, USA, June 13-19, 2020, pp. 9301‚Äì9309. Computer Vision Foundation / IEEE, 2020a. Aditya Golatkar, Alessandro Achille, and Stefano Soatto. Forgetting outside the box: Scrubbing deep networks of information accessible from input-output observations. In Proceedings of the European Conference on Computer Vision (ECCV), pp. 383‚Äì398. Springer, 2020b. Ian J. Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron C. Courville, and Yoshua Bengio. Generative adversarial networks. CoRR, abs/1406.2661, 2014. Laura Graves, Vineel Nagisetty, and Vijay Ganesh. Amnesiac machine learning. In Proceedings of the AAAI Conference on Artificial Intelligence, pp. 11516‚Äì11524, 2021. Ishaan Gulrajani, Faruk Ahmed, Mart¬¥ƒ±n Arjovsky, Vincent Dumoulin, and Aaron C. Courville. Improved training of wasserstein gans. In Advances in Neural Information Processing Systems, pp. 5767‚Äì5777, 2017. Anisa Halimi, Swanand Kadhe, Ambrish Rawat, and Nathalie Baracaldo. Federated unlearning: How to effi- ciently erase a client in fl? CoRR, abs/2207.05521, 2022. Kaiming He, Xinlei Chen, Saining Xie, Yanghao Li, Piotr Doll¬¥ar, and Ross B. Girshick. Masked autoencoders are scalable vision learners. In IEEE/CVF Conference on Computer Vision and Pattern Recognition, CVPR 2022, New Orleans, LA, USA, June 18-24, 2022, pp. 15979‚Äì15988. IEEE, 2022. Martin Heusel, Hubert Ramsauer, Thomas Unterthiner, Bernhard Nessler, and Sepp Hochreiter. Gans trained by a two time-scale update rule converge to a local nash equilibrium. In Advances in Neural Information Processing Systems, pp. 6626‚Äì6637, 2017. Jonathan Ho, Ajay Jain, and Pieter Abbeel. Denoising diffusion probabilistic models. In Advances in neural information processing systems, pp. 6840‚Äì6851, 2020. Emiel Hoogeboom, Alexey A. Gritsenko, Jasmijn Bastings, Ben Poole, Rianne van den Berg, and Tim Sali- mans. Autoregressive diffusion models. In The Tenth International Conference on Learning Representations, ICLR 2022, Virtual Event, April 25-29, 2022. OpenReview.net, 2022. Jinghan Jia, Jiancheng Liu, Parikshit Ram, Yuguang Yao, Gaowen Liu, Yang Liu, Pranay Sharma, and Sijia Liu. Model sparsification can simplify machine unlearning. CoRR, abs/2304.04934, 2023. 11 Published as a conference paper at ICLR 2024 Tero Karras, Samuli Laine, and Timo Aila. A style-based generator architecture for generative adversarial networks. In IEEE Conference on Computer Vision and Pattern Recognition, CVPR 2019, Long Beach, CA, USA, June 16-20, 2019, pp. 4401‚Äì4410. Computer Vision Foundation / IEEE, 2019. Tero Karras, Samuli Laine, Miika Aittala, Janne Hellsten, Jaakko Lehtinen, and Timo Aila. Analyzing and improving the image quality of stylegan. In 2020 IEEE/CVF Conference on Computer Vision and Pattern Recognition, CVPR 2020, Seattle, WA, USA, June 13-19, 2020, pp. 8107‚Äì8116. Computer Vision Foundation / IEEE, 2020. Diederik P. Kingma and Max Welling. An introduction to variational autoencoders. Found. Trends Mach. Learn., 12(4):307‚Äì392, 2019. Lingpeng Kong, Cyprien de Masson d‚ÄôAutume, Lei Yu, Wang Ling, Zihang Dai, and Dani Yogatama. A mutual information maximization perspective of language representation learning. In 8th International Conference on Learning Representations, ICLR 2020, Addis Ababa, Ethiopia, April 26-30, 2020. OpenReview.net, 2020. Zhifeng Kong and Kamalika Chaudhuri. Data redaction from conditional generative models. CoRR, abs/2305.11351, 2023. Dilip Krishnan, Piotr Teterwak, Aaron Sarna, Aaron Maschinot, Ce Liu, David Belanger, and William T. Free- man. Boundless: Generative adversarial networks for image extension. In 2019 IEEE/CVF International Conference on Computer Vision, ICCV 2019, Seoul, Korea (South), October 27 - November 2, 2019, pp. 10520‚Äì10529. IEEE, 2019. Aditya Kuppa, Lamine M. Aouad, and Nhien-An Le-Khac. Towards improving privacy of synthetic datasets. In Privacy Technologies and Policy - 9th Annual Privacy Forum, APF 2021, Oslo, Norway, June 17-18, 2021, Proceedings, volume 12703 of Lecture Notes in Computer Science, pp. 106‚Äì119. Springer, 2021. Meghdad Kurmanji, Peter Triantafillou, and Eleni Triantafillou. Towards unbounded machine unlearning. CoRR, abs/2302.09880, 2023. Tianhong Li, Huiwen Chang, Shlok Kumar Mishra, Han Zhang, Dina Katabi, and Dilip Krishnan. MAGE: masked generative encoder to unify representation learning and image synthesis. In IEEE/CVF Conference on Computer Vision and Pattern Recognition, CVPR 2023, Vancouver, BC, Canada, June 17-24, 2023, pp. 2142‚Äì2152. IEEE, 2023. Nils Lukas, Ahmed Salem, Robert Sim, Shruti Tople, Lukas Wutschitz, and Santiago Zanella B¬¥eguelin. An- alyzing leakage of personally identifiable information in language models. In 44th IEEE Symposium on Security and Privacy, SP 2023, San Francisco, CA, USA, May 21-25, 2023, pp. 346‚Äì363. IEEE, 2023. Saemi Moon, Seunghyuk Cho, and Dongwoo Kim. Feature unlearning for generative models via implicit feedback. CoRR, abs/2303.05699, 2023. Seth Neel, Aaron Roth, and Saeed Sharifi-Malvajerdi. Descent-to-delete: Gradient-based methods for machine unlearning. In Algorithmic Learning Theory, 16-19 March 2021, Virtual Conference, Worldwide, volume 132 of Proceedings of Machine Learning Research, pp. 931‚Äì962. PMLR, 2021. Thanh Tam Nguyen, Thanh Trung Huynh, Phi Le Nguyen, Alan Wee-Chung Liew, Hongzhi Yin, and Quoc Viet Hung Nguyen. A survey of machine unlearning. CoRR, abs/2209.02299, 2022. Canada Parliament. The personal information protection and electronic documents act (pipeda), 2019. URL https://laws-lois.justice.gc.ca/PDF/P-8.6.pdf. European Parliament and European Union Council. Regulation (eu) 2016/679 of the european parliament and of the council of 27 april 2016 on the protection of natural persons with regard to the processing of personal data and on the free movement of such data, and repealing directive 95/46/ec (general data protection regulation) (text with eea relevance), 2016. URL https://eur-lex.europa.eu/eli/reg/2016/679/oj. Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, Alban Desmaison, Andreas K¬®opf, Edward Z. Yang, Zachary DeVito, Martin Raison, Alykhan Tejani, Sasank Chilamkurthy, Benoit Steiner, Lu Fang, Junjie Bai, and Soumith Chintala. Pytorch: An imperative style, high-performance deep learning library. In Advances in Neural Information Processing Systems, pp. 8024‚Äì8035, 2019. Ben Poole, Sherjil Ozair, Aaron Van Den Oord, Alex Alemi, and George Tucker. On variational bounds of mutual information. In International Conference on Machine Learning, pp. 5171‚Äì5180. PMLR, 2019. 12 Published as a conference paper at ICLR 2024 Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, Gretchen Krueger, and Ilya Sutskever. Learning transferable visual models from natural language supervision. In International Conference on Machine Learning, pp. 8748‚Äì8763. PMLR, 2021. Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Bj¬®orn Ommer. High-resolution image synthesis with latent diffusion models. In IEEE/CVF Conference on Computer Vision and Pattern Recognition, CVPR 2022, New Orleans, LA, USA, June 18-24, 2022, pp. 10674‚Äì10685. IEEE, 2022. Chitwan Saharia, William Chan, Huiwen Chang, Chris A. Lee, Jonathan Ho, Tim Salimans, David J. Fleet, and Mohammad Norouzi. Palette: Image-to-image diffusion models. In SIGGRAPH ‚Äô22: Special Interest Group on Computer Graphics and Interactive Techniques Conference, Vancouver, BC, Canada, August 7 - 11, 2022, pp. 15:1‚Äì15:10. ACM, 2022a. Chitwan Saharia, William Chan, Saurabh Saxena, Lala Li, Jay Whang, Emily L. Denton, Seyed Kamyar Seyed Ghasemipour, Raphael Gontijo Lopes, Burcu Karagol Ayan, Tim Salimans, Jonathan Ho, David J. Fleet, and Mohammad Norouzi. Photorealistic text-to-image diffusion models with deep language understanding. In Advances in Neural Information Processing Systems, pp. 36479‚Äì36494, 2022b. Tim Salimans and Jonathan Ho. Progressive distillation for fast sampling of diffusion models. In The Tenth International Conference on Learning Representations, ICLR 2022, Virtual Event, April 25-29, 2022. Open- Review.net, 2022. Tim Salimans, Ian J. Goodfellow, Wojciech Zaremba, Vicki Cheung, Alec Radford, and Xi Chen. Improved techniques for training gans. In Advances in Neural Information Processing Systems, pp. 2226‚Äì2234, 2016. Christoph Schuhmann, Romain Beaumont, Richard Vencu, Cade Gordon, Ross Wightman, Mehdi Cherti, Theo Coombes, Aarush Katta, Clayton Mullis, Mitchell Wortsman, Patrick Schramowski, Srivatsa Kundurthy, Katherine Crowson, Ludwig Schmidt, Robert Kaczmarczyk, and Jenia Jitsev. LAION-5B: an open large- scale dataset for training next generation image-text models. In Advances in Neural Information Processing Systems, 2022. Gowthami Somepalli, Vasu Singla, Micah Goldblum, Jonas Geiping, and Tom Goldstein. Diffusion art or digital forgery? investigating data replication in diffusion models. In IEEE/CVF Conference on Computer Vision and Pattern Recognition, CVPR 2023, Vancouver, BC, Canada, June 17-24, 2023, pp. 6048‚Äì6058. IEEE, 2023. Bowen Song, Soo Min Kwon, Zecheng Zhang, Xinyu Hu, Qing Qu, and Liyue Shen. Solving inverse problems with latent diffusion models via hard data consistency. CoRR, abs/2307.08123, 2023. Yang Song and Stefano Ermon. Improved techniques for training score-based generative models. In Advances in Neural Information Processing Systems, pp. 12438‚Äì12448, 2020. Hui Sun, Tianqing Zhu, Wenhan Chang, and Wanlei Zhou. Generative adversarial networks unlearning. CoRR, abs/2308.09881, 2023. Ayush K Tarun, Vikram S Chundawat, Murari Mandal, and Mohan Kankanhalli. Fast yet effective machine unlearning. IEEE Transactions on Neural Networks and Learning Systems, 2023a. Ayush Kumar Tarun, Vikram Singh Chundawat, Murari Mandal, and Mohan S. Kankanhalli. Deep regression unlearning. In International Conference on Machine Learning, pp. 33921‚Äì33939. PMLR, 2023b. Kushal Tirumala, Aram H. Markosyan, Luke Zettlemoyer, and Armen Aghajanyan. Memorization without overfitting: Analyzing the training dynamics of large language models. In Advances in Neural Information Processing Systems, pp. 38274‚Äì38290, 2022. Zhan Tong, Yibing Song, Jue Wang, and Limin Wang. Videomae: Masked autoencoders are data-efficient learners for self-supervised video pre-training. In Advances in Neural Information Processing Systems, volume 35, pp. 10078‚Äì10093, 2022. Bram Wallace, Akash Gokul, and Nikhil Naik. EDICT: exact diffusion inversion via coupled transforma- tions. In IEEE/CVF Conference on Computer Vision and Pattern Recognition, CVPR 2023, Vancouver, BC, Canada, June 17-24, 2023, pp. 22532‚Äì22541. IEEE, 2023. Alexander Warnecke, Lukas Pirch, Christian Wressnegger, and Konrad Rieck. Machine unlearning of features and labels. In 30th Annual Network and Distributed System Security Symposium, NDSS 2023, San Diego, California, USA, February 27 - March 3, 2023. The Internet Society, 2023. 13 Published as a conference paper at ICLR 2024 Mike Wu, Chengxu Zhuang, Milan Mosse, Daniel Yamins, and Noah Goodman. On mutual information in contrastive learning for visual representations. arXiv preprint arXiv:2005.13149, 2020. Yuhuai Wu, Yuri Burda, Ruslan Salakhutdinov, and Roger B. Grosse. On the quantitative analysis of decoder- based generative models. In 5th International Conference on Learning Representations, ICLR 2017, Toulon, France, April 24-26, 2017, Conference Track Proceedings, 2017. Weihao Xia, Yulun Zhang, Yujiu Yang, Jing-Hao Xue, Bolei Zhou, and Ming-Hsuan Yang. GAN inversion: A survey. IEEE Transactions on Pattern Analysis and Machine Intelligence, 45(3):3121‚Äì3138, 2023. Heng Xu, Tianqing Zhu, Lefeng Zhang, Wanlei Zhou, and Philip S. Yu. Machine unlearning: A survey. ACM Comput. Surv., 56(1), aug 2023. Ling Yang, Zhilong Zhang, Yang Song, Shenda Hong, Runsheng Xu, Yue Zhao, Yingxia Shao, Wentao Zhang, Ming-Hsuan Yang, and Bin Cui. Diffusion models: A comprehensive survey of methods and applications. CoRR, abs/2209.00796, 2022. Lvmin Zhang and Maneesh Agrawala. Adding conditional control to text-to-image diffusion models. CoRR, abs/2302.05543, 2023. Xulong Zhang, Jianzong Wang, Ning Cheng, Yifu Sun, Chuanyao Zhang, and Jing Xiao. Machine unlearning methodology based on stochastic teacher network. In Advanced Data Mining and Applications - 19th In- ternational Conference, ADMA 2023, Shenyang, China, August 21-23, 2023, Proceedings, Part V, volume 14180 of Lecture Notes in Computer Science, pp. 250‚Äì261. Springer, 2023a. Yongjing Zhang, Zhaobo Lu, Feng Zhang, Hao Wang, and Shaojing Li. Machine unlearning by reversing the continual learning. Applied Sciences, 13(16):9341, 2023b. Bolei Zhou, Agata Lapedriza, Aditya Khosla, Aude Oliva, and Antonio Torralba. Places: A 10 million image database for scene recognition. IEEE Transactions on Pattern Analysis and Machine Intelligence, 40(6): 1452‚Äì1464, 2017. URL https://github.com/CSAILVision/places365. Jun-Yan Zhu, Taesung Park, Phillip Isola, and Alexei A. Efros. Unpaired image-to-image translation using cycle-consistent adversarial networks. In IEEE International Conference on Computer Vision, ICCV 2017, Venice, Italy, October 22-29, 2017, pp. 2242‚Äì2251. IEEE Computer Society, 2017. 14 Published as a conference paper at ICLR 2024 A INFINITELY MANY PROBABILITY WITH INFINITE KL-DIVERGENCE In Section 3.2, we mention that there are infinitely many probability distributions that have infinity KL diver- gence with a given distribution. We provide the proof below: Proposition 1 There are infinitely many probability distributions that have a positively infinite value of KL- divergence with any general discrete probability distribution P (X) that is defined as follows: 0 <= P (X = i) < 1, N‚àë i=1 P (X = i) = 1, i ‚àà [N ], N ‚â• 2 Proof. Based on P (X), we build another distribution Q(X) as follows: Q(X = i) = Ô£± Ô£¥Ô£≤ Ô£¥Ô£≥ P (X=i) 1‚àíP (X=j)‚àíP (X=k)+Œ∫ , if i Ã∏= j and i Ã∏= k 0, if i = j Œ∫ 1‚àíP (X=j)‚àíP (X=k)+Œ∫ , if i = k j, k ‚àà [N ], Œ∫ > 0 where j satisfies P (X = j) > 0 and k sastifies j Ã∏= k. Clearly, 0 <= Q(X = i) < 1 and ‚àëN i=1 Q(X = i) = 1. Therefore, Q(X) is a valid probability distribution. We next compute the KL divergence between P and Q. D(P ||Q) = N‚àë i=1 P (X = i)log P (X = i) Q(X = i) = P (X = j)log ( P (X = j) Q(X = j) ) + ‚àë i‚àà[N ],iÃ∏=j P (X = i)log ( P (X = i) Q(X = i) ) = P (X = j)log ( P (X = j) 0 ) + ‚àë i‚àà[N ],iÃ∏=j P (X = i)log ( P (X = i) Q(X = i) ) = +‚àû We note that Œ∫ can be any positive real number; hence, we can obtain infinitely many Q(X) by varying the value of Œ∫. Hence, there are infinitely many Q that have a positively infinite value of KL-divergence with P . In general, one can replace the set [N ] with any discrete set. This completes our proof. ‚ñ° The proof for the continuous distribution is very similar to the discrete case as shown below. Proposition 2 There are infinitely many probability distributions that have the a positively infinite value of KL- divergence with any general continuous probability distribution with the following probability density function (PDF) p(x): p(x) ‚â• 0, x ‚àà S, ‚à´ x‚ààS p(x)dx = 1 Proof. Based on p(x), we build another distribution with PDF q(x) as follows: q(x) = { p(x) 1‚àí‚à´ x‚ààS1 p(x) , if x ‚àà S\\(S1) 0, if x ‚àà S1 , S1 ‚äÇ S where S1 satisfies 0 < ‚à´ x‚ààS1 p(x)dx < 1. Clearly, q(x) ‚â• 0 and ‚à´ x‚ààS q(x)dx = 1. Therefore, q(x) is a valid probability density function. We next compute the KL divergence between p and q. D(p||q) = ‚à´ x‚ààS p(x)log ( p(x) q(x) ) dx = ‚à´ x‚ààS1 p(x)log ( p(x) q(x) ) dx + ‚à´ x‚ààS\\S1 p(x)log ( p(x) q(x) ) dx = ‚à´ x‚ààS1 p(x)log ( p(x) 0 ) dx + ‚à´ x‚ààS\\S1 p(x)log ( p(x) q(x) ) dx = +‚àû We note that given a continuous distribution, there are infinitely many possible S1; hence, we can obtain infinitely many q(x) by using different S1. Hence, there are infinitely many q that have a positively infinite value of KL-divergence with p. This completes our proof. ‚ñ° 15 Published as a conference paper at ICLR 2024 B PROOF OF THEOREM 1 Proof. Directly computing mutual information (MI) between two random variables is not feasible. Fortunately, there are some variational MI bounds that are relatively easy to compute. A popular approach is to lower bound MI with InfoNCE (Belghazi et al., 2018; Wu et al., 2020; Poole et al., 2019; Kong et al., 2020). Given two random variables X1 and X2, MI is bounded by InfoNCE is defined as follows: I(X1; X2) ‚â• I N CE(X1; X2) = log (K) + E Ô£Æ Ô£∞ K‚àë i=1 1 K log e g1(x1i ) T g2(x2i ) ‚àëK j=1 eeg1(x1i )T g2 (x2j ) Ô£π Ô£ª (B.11) where the expectation is over K independent samples from the joint distribution: Œ†jp(x1j , x2j ); g1 and g2 are two functions that map the random variables into representation vectors, e.g., the encoder network EŒ∏ of I2I generative models. Following the standard practice of InfoNCE, we use the inner product of the encoder output vectors as the critic function. Therefore, the InfoNCE between the ground truth images X and reconstructed images ÀÜX is written as follows: I N CE(X; ÀÜX) = log (K) + Ex,ÀÜx Ô£Æ Ô£∞ 1 K log eEŒ∏0 (xi) T EŒ∏0 (ÀÜxi) ‚àëK j=1 eEŒ∏0 (xi)T EŒ∏0 (ÀÜxj) Ô£π Ô£ª (B.12) Multiple works show that the encoder of the I2I generative models can be treated as the inverse function of the decoder (Wallace et al., 2023; Song et al., 2023; Xia et al., 2023; Kingma & Welling, 2019). In other words, EŒ∏0 (Dœï0 (z)) = z (B.13) Given the assumption that the target model use the same decoder as the original model, we can express X and ÀÜX as follows: x = Dœï0 (EŒ∏0 (T (x)))) , ÀÜx = Dœï0 (EŒ∏(T (x)))) (B.14) By using the above relationships in Eq. (B.13) and Eq. (B.14), we have EŒ∏0 (x)T EŒ∏0 (ÀÜx) = EŒ∏0 (Dœï0 (EŒ∏0 (T (x)))) T EŒ∏0 (Dœï0 (EŒ∏ (T (ÀÜx)))) = EŒ∏0 (T (x1)) T EŒ∏ (T (x2)) (B.15) Retain set Recall the assumption that the output of the encoder is normalized, i.e., ‚à•EŒ∏ (x)‚à•2 = 1 and ‚à•EŒ∏0 (x)‚à•2 = 1. Therefore, we can rewrite Eq. (B.15) for the ground truth retain samples {xri } and their reconstructions {ÀÜxri } and as follows: EŒ∏0 (xri )T EŒ∏0 (ÀÜxri ) = EŒ∏0 (T (xri ))T EŒ∏ (T (xri )) = 1 2 ‚à•EŒ∏0 (T (xri ))‚à•2 2 + 1 2 ‚à•EŒ∏ (T (xri ))‚à• 2 2 ‚àí 1 2 ‚à•EŒ∏0 (T (xri )) ‚àí EŒ∏ (T (xri ))‚à•2 2 = 1 2 ( 2 ‚àí ‚à•EŒ∏0 (T (xri )) ‚àí EŒ∏ (T (xri ))‚à•2 2) = 1 2 ( 2 ‚àí œµ 2 i ) = 1 ‚àí œµ 2 i 2 (B.16) where œµi = ‚à•EŒ∏0 (T (xri )) ‚àí EŒ∏ (T (xri ))‚à•2 is the L2 loss between the representation of target model en- coder EŒ∏ and original model encoder EŒ∏0 . We then bound the EŒ∏0 (xri )T EŒ∏0 (ÀÜxrj ) as follows: EŒ∏0 (xri ) T EŒ∏0 (ÀÜxrj ) =EŒ∏0 (T (xri )) T EŒ∏ ( T ( xrj )) =EŒ∏0 (T (xri )) T ( EŒ∏ ( T ( xrj )) ‚àí EŒ∏0 ( T ( xrj ))) + EŒ∏0 (T (xri ))T EŒ∏0 ( T ( xrj )) =EŒ∏0 (T (xri ))T ( EŒ∏ ( T ( xrj )) ‚àí EŒ∏0 ( T ( xrj ))) + Rij ‚â§ ‚à•EŒ∏0 (T (xri ))‚à•2 ‚àó ‚à• ‚à•EŒ∏ ( T ( xrj )) ‚àí EŒ∏0 T ( xrj )‚à• ‚à•2 + Rij =1 ‚àó œµj + Rij =œµj + Rij (B.17) 16 Published as a conference paper at ICLR 2024 where Rij = EŒ∏0 (T (xri ))T EŒ∏0 ( T ( xrj )) and the ‚Äò‚â§‚Äô comes from the Cauchy‚ÄìSchwarz inequality. The above bound is tight if {œµi = 0, i ‚àà [K]}. By combining the Eq. (B.12), Eq. (B.16), and Eq. (B.17), we can link the InfoNCE loss with the L2 loss: I N CE(Xr; ÀÜXr) = log (K) + E Ô£Æ Ô£∞ 1 K log e EŒ∏0 (xi) T EŒ∏0 (ÀÜxi) ‚àëK j=1 e EŒ∏0 (xi)T EŒ∏0 (ÀÜxj) Ô£π Ô£ª = log (K) + E Ô£Æ Ô£∞ 1 K log e 1‚àí œµ2 i 2 ‚àëK j=1 e EŒ∏0 (xi)T EŒ∏0 (ÀÜxj) Ô£π Ô£ª ‚â• log (K) + E Ô£Æ Ô£∞ 1 K log e 1‚àí œµ2 i 2 ‚àëK j=1 e œµj +Rij Ô£π Ô£ª = log (K) ‚àí E [ K‚àë i=1 1 K log ( e œµ2 i 2 ‚àí1 K‚àë j=1 e œµj +Rij )] (B.18) By combining Eq. (B.11), we obtain the results on the retain set: I(Xr; ÀÜXr) ‚â• log (K) ‚àí E [ K‚àë i=1 1 K log ( e œµ2 i 2 ‚àí1 K‚àë j=1 eœµj +Rij )] (B.19) Forget set The proof on the forget set is very similar to the retain set. By adapting Eq. (B.16) and Eq. (B.17) for the forget set, we first calculate the inner product of the embedding vector between n and xf : EŒ∏0 (ni)T EŒ∏0 (ÀÜxfi ) = EŒ∏0 (T (ni))T EŒ∏ (T (xfi )) = 1 2 ( ‚à•EŒ∏0 (T (ni))‚à• 2 2 + ‚à•EŒ∏ (T (xfi ))‚à• 2 2 ‚àí ‚à•EŒ∏0 (T (ni)) ‚àí EŒ∏ (T (xfi ))‚à• 2 2) = 1 2 ( 2 ‚àí ‚à•EŒ∏0 (T (ni)) ‚àí EŒ∏ (T (xfi ))‚à•2 2) = 1 2 ( 2 ‚àí œµ 2 i ) = 1 ‚àí Œ¥2 i 2 (B.20) and EŒ∏0 (ni)T EŒ∏0 (ÀÜxfj ) =EŒ∏0 (T (ni)) T EŒ∏ ( T ( xfj )) =EŒ∏0 (T (ni)) T ( EŒ∏ ( T ( xfj )) ‚àí EŒ∏0 (T (nj))) + EŒ∏0 (T (ni)) T EŒ∏0 (T (nj)) = ‚à•EŒ∏0 (T (ni))‚à•2 ‚àó ‚à• ‚à•EŒ∏ ( T ( xfj )) ‚àí EŒ∏0 T (nj)‚à• ‚à•2 + Fij =1 ‚àó Œ¥j + Fij =Œ¥j + Fij (B.21) where Œ¥i = ‚à•EŒ∏0 (T (ni)) ‚àí EŒ∏ (T (xfi ))‚à•2 and Fij = EŒ∏0 (T (ni)) T EŒ∏0 (T (nj)). xfi are the data sam- ples in the forget set and ni ‚àº N (0, Œ£). Combining the above two equation with Eq. (B.12): I N CE(n; ÀÜXf ) = log (K) + E Ô£Æ Ô£∞ 1 K log e EŒ∏0 (ni) T EŒ∏0 (ÀÜxfi ) ‚àëK j=1 e EŒ∏0 (ni)T EŒ∏0 (ÀÜxfj ) Ô£π Ô£ª = log (K) + E Ô£Æ Ô£∞ 1 K log e 1‚àí Œ¥2 i 2 ‚àëK j=1 e EŒ∏0 (ni)T EŒ∏0 (ÀÜxfj ) Ô£π Ô£ª ‚â• log (K) + E Ô£Æ Ô£∞ 1 K log e 1‚àí Œ¥2 i 2 ‚àëK j=1 e Œ¥j +Fij Ô£π Ô£ª = log (K) ‚àí E [ K‚àë i=1 1 K log ( e Œ¥2 i 2 ‚àí1 K‚àë j=1 e Œ¥j +Fij )] (B.22) 17 Published as a conference paper at ICLR 2024 By combining the above equation with Eq. (B.11), we obtain the results for the forget set: I(n; ÀÜXf ) ‚â• log (K) ‚àí E [ K‚àë i=1 1 K log ( e Œ¥2 i 2 ‚àí1 K‚àë j=1 e Œ¥j +Fij )] (B.23) This completes our proof. ‚ñ° C IMPLEMENTATION DETAILS C.1 DATASETS AND CODE BASE Diffusion Models. We verify our approach on a diffusion model that is trained on entire Places-365 training dataset (Saharia et al., 2022a; Zhou et al., 2017). We randomly select 50 classes out of 365 classes as the retain set and another 50 classes as the forget set. For each class, we select 5000 images from the Places-365 training set; we then combine them together as the training set for unlearning. By using the approach defined in Eq. (10), we obtain the target model. We then evaluate the obtained model on both forget set and retain set, with 100 images per class from the Places-365 validation set. Hence, we have 5,000 validation images for both the retains and forget sets. Since Saharia et al. did not release the code, our code is implemented based on an open source re-implementation (GitHub). Our experiments are using their provided model checkpoint on Places-365 dataset. VQ-GAN We evaluate our approach on a VQ-GAN model that is trained on entire ImageNet-1K training dataset (Li et al., 2023; Deng et al., 2009). We randomly select 100 classes out of 1000 classes as the retain set and another 100 classes as the forget set. We select 100 images per class from the training set as the training set for unlearning. We then apply our proposed approach to the original model and obtain the target model. For the main results reported in Tabel 1 and Tabel 2, we evaluate the obtained model on both forget set and retain set, with 50 images per class from the ImageNet-validation set; hence, we have 5,000 validation images for both the retains set and forget set. For the other results (in ablation study), we use a smaller version validation set, with 5 images per class from the ImageNet-validation set; hence, we have 500 validation images for both the retains set and forget set. Our code is implemented based on the offically released code of Li et al. (2023) (GitHub). Our experiments are using their provided ViT-Base model checkpoints. MAE We evaluate our approach on a MAE model and an MAE model that is trained on the entire ImageNet- 1K training dataset (He et al., 2022). The dataset setup is exactly the same as VQ-GAN (check the upper paragraph). Our code is implemented based on the offically released code of He et al. (2022) (GitHub). Our experiments are using their provided ViT-Base model checkpoints. C.2 EVALUATION METRICS Inception score (IS) For ImageNet-1K, we directly use the Inception-v3 model checkpoint from torchvision library to compute the IS. For Places-365, we used the ResNet-50 model checkpoint from the official release to compute IS (Zhou et al., 2017). Fr¬¥echet inception distance (FID) For both ImageNet-1K and Places-365, we directly use the backbone net- work of the Inception-v3 model checkpoint from Torchvision library to compute the FID. CLIP We use CLIP with ViT-H-14 as the backbone to generate the embedding vectors of each reconstructed image from the original model and unlearned model (Radford et al., 2021). Then we compute the cosine similarity of these embedding vectors among DF and DR separately. C.3 TRAINING HYPER-PARAMETERS Patch Size For all of the models we evaluate in this paper (including diffusion models, VQ-GAN and MAE), the networks are vision transformer (Dosovitskiy et al., 2021) based architecture. We set the size of each patch as 16 √ó 16 pixels for all experiments. For example, cropping 8 √ó 8 patches means removing 128 √ó 128 pixels. We set Œ± = 0.25 (cf. Eq. (10)). Diffusion Models We set the learning rate as 10 ‚àí5 with no weight decay. We use the Adam as the optimizer and conduct the unlearning for 3 epochs. We set the input resolution as 256 and set the batch size as 8 per GPU. Overall, it takes 1.5 hours on a 8 NVIDIA A10G server. We set Œ± = 0.25 (cf. Eq. (10)). VQ-GAN&MAE We set the learning rate as 10 ‚àí4 with no weight decay. We use the AdamW as the optimizer with Œ≤ = (0.9, 0.95) and conduct the unlearning for 5 epochs. We set the input resolution as 256 for VQ-GAN and 224 for MAE. We set the batch size as 16 per GPU. Overall, it takes one hour on a 4 NVIDIA A10G server. We set Œ± = 0.25 (cf. Eq. (10)). 18 Published as a conference paper at ICLR 2024 0 200 400 600 0 200 400 600 0.0 0.5 1.0 1.5 2.0 (a) MNIST 0 500 1000 0 200 400 600 800 1000 0.5 1.0 1.5 2.0 (b) CIFAR-10 0 500 1000 0 200 400 600 800 1000 0.25 0.50 0.75 1.00 1.25 (c) CIFAR-100 Figure C.5: Covariance matrix of three commonly datasets. For CIFAR10/100, we convert the images into gray-scale images. We take the absolute value of the covariance matrix for better illus- tration. Algorithm 1 Pseudo Code of Our Unlearning Algorithm 1: Inputs: Orginal model hŒ∏0,œï0 = Dœï0 ‚ó¶ EŒ∏0 Retain set DR, Forget set DF Coefficient Œ±, learning rate Œ∂, and #Epochs E 2: Outputs: Target model hŒ∏,œï = Dœï ‚ó¶ EŒ∏ 3: Initialize: Copy hŒ∏,œï to hŒ∏,œï, i.e., hŒ∏,œï ‚áê hŒ∏0,œï0 4: for e = 1 to E do 5: Sample {xr} from DR 6: Sample {xf } from DF 7: Sample {n} from N (0, Œ£) 8: Ensure: |{xr}| = |{xf }|, i.e., make retain samples and forget samples balanced 9: Compute loss: l = ‚à•EŒ∏(T (xr)) ‚àí EŒ∏0 (T (xr))‚à•2 + Œ± ‚à•EŒ∏(T (xf )) ‚àí EŒ∏0(T (n))‚à•2 10: Update the parameters of the target encoder EŒ∏: Œ∏ ‚áê Œ∏ ‚àí Œ∂‚àáŒ∏l 11: end for C.4 OUR UNLEARNING ALGORITHM Selection of Œ£ in Eq. (10) To conduct our unlearning algorithm, we need to compute the Œ£ in Eq. (10), where Œ£ is the the covariance matrix for the distribution of training images. Ideally, we should use the exact Œ£ of the images measured on the forget set. However, there are some com- putational barriers to using the exact Œ£ for a high-resolution image dataset. Specifically, consider a com- monly used 256√ó256 resolution for image generation tasks, the distribution of the generated images will have 256 √ó 256 √ó 3 ‚âà 2 √ó 10 5 dimensions. The size of the covariance matrix Œ£ for such a high-dimensional dis- tribution is around (2 √ó 105) 2 = 4 √ó 10 10, which requires around 144GB memory if stored in float precision thus is not practical. Consequently, to address the computational barrier of Œ£, we use some approximated methods derived from some empirical observations on some small datasets. Specifically, we compute the exact Œ£ for some small- scale image dataset, including MNIST and CIFAR10/100. ‚Ä¢ Off-diagonal elements: To find some empirical inspirations, we compute the covariance matrix for three commonly dataset, MNIST, CIFAR10 and CIFAR100. As shown in Fig. C.5, most of the off- diagonal elements are very close to ‚Äò0‚Äô. Hence, in our experiments, we set the off-diagonal elements of Œ£ to ‚Äò0‚Äô ‚Ä¢ Diagonal elements: Since the images are normalized (i.e., subtract the mean value and divided by the standard deviation), we set the diagonal elements of Œ£ as ‚Äò1‚Äô, i.e., Œ£(i, i) = 1. Therefore, we use the identity matrix as the approximation of exact Œ£: Œ£ = I where I is the identity matrix. We set Œ£ = I as the default setup for our approach and baseline methods. In short, using I to approximate Œ£ is a practical approximation alternative due to the extremely high compu- tational costs of Œ£ for high-resolution images. For future work, given our theoretical analysis, we believe that 19 Published as a conference paper at ICLR 2024 our approach can achieve better results (lower image quality) on forget set if we can find a way to use the exact Œ£. Hence, we plan to explore the potential to reduce the computation of exact Œ£ with low-rank approximation thus enabling the use of more accurate data-driven Œ£. Pseudo code Based on our unlearning approach defined in Section 3.3, we implement the unlearning algo- rithm for I2I generative models. We provide the pseudo code in Algorithm 1. As shown, for each batch, we sample the same number of retain samples and forge samples. We then compute the loss by using Eq. (10) and update the parameters of the target model‚Äôs encoder. C.5 LOSS FUNCTION OF OUR APPROACH As shown in Eq. (10), we input the Gaussian noise to the original model as the reference for the forget set. For VQ-GAN and MAE, we can directly use Eq. (10). For diffusion models, in principle, we still replace the forget sample with Gaussian noise as the input for the original encoder. We next discuss the details for the diffusion models. We first write the loss function for the normal training of diffusion models first: ExEŒ≥‚àºN (0,I)EŒ∑ ‚à• ‚à• ‚à• ‚à• ‚à• ‚à• ‚à• Dœï ‚ó¶ EŒ∏ Ô£´ Ô£¨ Ô£≠T (x), ‚àö Œ∑x + ‚àö1 ‚àí Œ∑ Œ≥ Ô∏∏ Ô∏∑Ô∏∑ Ô∏∏ Àúx , Œ∑ Ô£∂ Ô£∑ Ô£∏ ‚àí Œ≥ ‚à• ‚à• ‚à• ‚à• ‚à• ‚à• ‚à•p (C.24) where x is the ground truth image; T (x) is the transformed images, e.g., a cropped image for image uncropping tasks and and low-resolution image for image super-resolution. Œ∑ is the forward process variance coefficient. For more details, please refer to the Saharia et al. (2022a). Now, we introduce the unlearning optimization function for diffusion models: arg min Œ∏ Exr ,xf ,nEŒ≥‚àºN (0,I)EŒ∑ { ‚à•EŒ∏ (T (xr), Àúxr, Œ∑) ‚àí EŒ∏0 (T (xr), Àúxr, Œ∑)‚à•2 +Œ± ‚à•EŒ∏ (T (xf ), Àúxf , Œ∑) ‚àí EŒ∏0 (T (xf ), n, Œ∑)‚à•2 }, xr ‚àà DR, xf ‚àà DF , n ‚àº N (0, Œ£) (C.25) where Àúxr = ‚àöŒ∑xr + ‚àö 1 ‚àí Œ∑ Œ≥ and Àúxf = ‚àö Œ∑xf + ‚àö1 ‚àí Œ∑ Œ≥. Essentially, we replace the Àúxf with the Gaussian noise n as the input for the original encoder. Note that, Saharia et al. adopt an U-Net as the network architecture; thus the encoder has multiple-stage outputs. We flatten these multiple outputs into vectors and then combine them as a single representation vector . We remark the equation for diffusion models looks slightly different from VQ-GAN and MAE, but they are actually following the same principle defined in Eq. (10); that is, we replace the real forget samples with the Gaussian noise as the input for the original encoder. C.6 BASELINES We use the exact same setup as introduced in the main paper and Appendix C.3. We provide the loss function for different baseline methods below. For the baselines, the unlearning is achieved by minimizing the loss values. C.6.1 MAX LOSS MAX LOSS maximizes the training loss w.r.t. the ground truth images on the forget set. Hence, we use the original loss function for both retains set and forget set, but assign a negative coefficient for the forget set. We do not modify the loss for the retains set. ‚Ä¢ Diffusion Models arg min Œ∏,œï Exr ,xf EŒ≥‚àºN (0,I)EŒ∑ { ‚à•Dœï ‚ó¶ EŒ∏ (T (xr), Àúxr, Œ∑) ‚àí Œ≥‚à•2 ‚àí Œ± ‚à•Dœï ‚ó¶ EŒ∏ (T (xf ), Àúxf , Œ∑) ‚àí Œ≥‚à•2 } (C.26) where Àúxr = ‚àöŒ∑xr + ‚àö1 ‚àí Œ∑ Œ≥ and Àúxf = ‚àö Œ∑xf + ‚àö1 ‚àí Œ∑ Œ≥. T (¬∑) is the transformed function, e.g., a cropped image for image uncropping tasks. 20 Published as a conference paper at ICLR 2024 ‚Ä¢ VQ-GAN arg max Œ∏,œï Exr ,xf {CJ (Dœï ‚ó¶ EŒ∏ (T (xr)) , xr) ‚àí Œ±CJ (Dœï ‚ó¶ EŒ∏ (T (xf )) , xf ) } (C.27) where J is a discriminator network used to predict whether the images are real images or generated im- ages; CJ is the cross entropy of the discriminator prediction. We also note that, during unlearning, the discriminator J is also updated in the normal training way. Please check more details in Li et al. (2023). ‚Ä¢ MAE arg min Œ∏,œï Exr ,xf { ‚à•Dœï ‚ó¶ EŒ∏ (T (xr)) ‚àí xr‚à•2 ‚àí Œ± ‚à•Dœï ‚ó¶ EŒ∏ (T (xf )) ‚àí xf ‚à•2 } (C.28) T (¬∑) is the transformed function, e.g., a cropped image for image uncropping tasks. C.6.2 RETAIN LABEL RETAIN LABEL minimizes training loss by setting the retain samples as the ground truth for the forget set. ‚Ä¢ Diffusion Models arg min Œ∏,œï Exr ,xf EŒ≥‚àºN (0,I)EŒ∑ { ‚à•Dœï ‚ó¶ EŒ∏ (T (xr), Àúxr, Œ∑) ‚àí Œ≥‚à•2 + Œ± ‚à•Dœï ‚ó¶ EŒ∏ (T (xf ), Àúxr, Œ∑) ‚àí Œ≥‚à•2 } (C.29) where Àúxr = ‚àöŒ∑xr + ‚àö 1 ‚àí Œ∑ Œ≥. As shown, the Àúxf in Eq. (C.26) is replaced by the the retain samples Àúxr. ‚Ä¢ VQ-GAN arg max Œ∏,œï Exr ,xf {CJ (Dœï ‚ó¶ EŒ∏ (T (xr)) , xr) + Œ±CJ (Dœï ‚ó¶ EŒ∏ (T (xf )) , xr) } (C.30) where J is a discriminator network used to predict whether the images are real images or generated images; CJ is the cross entropy of the discriminator prediction. As shown, the reference xf in the second term of Eq. (C.27) is replaced by the retain sample xr. ‚Ä¢ MAE arg min Œ∏,œï Exr ,xf { ‚à•Dœï ‚ó¶ EŒ∏ (T (xr)) ‚àí xr‚à•2 + Œ± ‚à•Dœï ‚ó¶ EŒ∏ (T (xf )) ‚àí n‚à•2 } (C.31) As shown, the target Àúxf in the second term of Eq. (C.28) is replaced by the retain sample xr. C.6.3 NOISY LABEL NOISY LABEL minimizes training loss by setting the Gaussian noise as the ground truth images for the for- get set. Hence we directly use the original loss function by replacing the ground truth images with standard Gaussian noise for the forget set. We do not modify the loss for the retains set. ‚Ä¢ Diffusion Models arg min Œ∏,œï Exr ,xf EŒ≥‚àºN (0,I)EŒ∑ { ‚à•Dœï ‚ó¶ EŒ∏ (T (xr), Àúxr, Œ∑) ‚àí Œ≥‚à•2 + Œ± ‚à•Dœï ‚ó¶ EŒ∏ (T (xf ), Œ∑, Œ∑) ‚àí Œ≥‚à•2 } (C.32) where Àúxr = ‚àö Œ∑xr + ‚àö 1 ‚àí Œ∑ Œ≥. As shown, the Àúxf in Eq. (C.26) is replaced by the Gaussian noise Œ∑. T (¬∑) is the transformed function, e.g., a cropped image for image uncropping tasks. ‚Ä¢ VQ-GAN arg max Œ∏,œï Exr ,xf { CJ (Dœï ‚ó¶ EŒ∏ (T (xr)) , xr) + Œ±CJ (Dœï ‚ó¶ EŒ∏ (T (xf )) , n) } (C.33) where J is a discriminator network used to predict whether the images are real images or generated images; CJ is the cross entropy of the discriminator‚Äôs prediction. As shown, the reference xf in the second term of Eq. (C.27) is replaced by the Gaussian noise n. ‚Ä¢ MAE arg min Œ∏,œï Exr ,xf { ‚à•Dœï ‚ó¶ EŒ∏ (T (xr)) ‚àí xr‚à•2 + Œ± ‚à•Dœï ‚ó¶ EŒ∏ (T (xf )) ‚àí n‚à•2 } (C.34) As shown, the target Àúxf in the second term of Eq. (C.28) is replaced by the Gaussian noise n. 21 Published as a conference paper at ICLR 2024 C.6.4 RANDOM ENCODER RANDOM ENCODER minimizes the L2 loss between the Gaussian noise and the representation vector of the encoder for the forget set. ‚Ä¢ Diffusion Models arg min Œ∏ Exr ,xf EŒ≥‚àºN (0,I)EŒ∑ { ‚à•EŒ∏ (T (xr), Àúxr, Œ∑) ‚àí EŒ∏0 (T (xr), Àúxr, Œ∑)‚à•2 +Œ± ‚à•EŒ∏ (T (xf ), Àúxf , Œ∑) ‚àí Œ∑‚à•2 } (C.35) where Àúxr = ‚àöŒ∑xr + ‚àö1 ‚àí Œ∑ Œ≥. As shown, the target for the forget set is directly the Gaussian noise instead of its embedding vector. ‚Ä¢ VQ-GAN&MAE arg min Œ∏ Exr ,xf { ‚à•EŒ∏ (T (xr)) ‚àí EŒ∏0 (T (xr))‚à•2 + Œ± ‚à•EŒ∏ (T (xf )) ‚àí n‚à•2 } (C.36) D SUPPLEMENTARY RESULTS 0 25 50 75 100 #Images per Class on Retain Set 80 100 120 140FIDForget Set Retain Set (a) VQ-GAN: FID 0 25 50 75 100 #Images per Class on Retain Set 9 10 11 12 13Inception Score Forget Set Retain Set (b) VQ-GAN: IS 0 25 50 75 100 #Images per Class on Retain Set 0.65 0.70 0.75 0.80CLIP Embedding Distance Forget Set Retain Set (c) VQ-GAN: CLIP 0 25 50 75 100 #Images per Class on Retain Set 150 200 250FIDForget Set Retain Set (d) MAE: FID 0 25 50 75 100 #Images per Class on Retain Set 2.5 5.0 7.5 10.0 12.5 15.0Inception Score Forget Set Retain Set (e) MAE: IS 0 25 50 75 100 #Images per Class on Retain Set 0.55 0.60 0.65 0.70 0.75CLIP Embedding Distance Forget Set Retain Set (f) MAE: CLIP Figure D.6: The performance of our approach under limited availability of the retain sample. The ‚Äú100 images per class‚Äù (right side of horizontal-axis) in these plots indicate a full retains set baseline. As shown, by gradually reducing the number of images for the retain set, the performance degrada- tion is negligible. Even for the extreme case where we only one image per class, the performance degradation is also small. D.1 ROBUSTNESS TO RETAIN SAMPLES AVAILABILITY In Table 1 and Table 2, we report the results under an extreme case where there is no real retain sample available. In this section, we relax the constraints by assuming the limited availability to the real retain samples. Specifically, on ImageNet-1K, we fix the forget set by using 100 images per class for the forget set; in total, we have 10K image for the forget set. As the baseline method, we have a retain set with 100 image per class as well (in total 10K); we call this a full retain set. We next vary the number of images per class for the retain set within the range of {1, 5, 10, 20, 25, 50} and compare the performance of the unlearned models under different values. To balance the number of forget sample and retain samples, we over sample the retain samples. For example, if we have 5 image per class for the retain set, we sample these images 20 times (since 100/5 = 20). 22 Published as a conference paper at ICLR 2024 As shown in Fig. D.6, compared to the full retain set (100 images per class), our approach is still effective with a slight performance degradation. Combining the results in Table 1 and Table 2, these results show the applicability and resilience of our approach in scenarios where actual the retain samples are limited or even unavailable.Ground TruthInput Original ModelMAX LOSSNOISY LABELRETAIN LABELRANDOM ENCODEROurs (a) Forget setGround TruthInput Original ModelMAX LOSSNOISY LABELRETAIN LABELRANDOM ENCODEROurs (b) Retain set Figure D.7: Diffusion models: cropping 4 √ó 4 patches at the center of the image, where each patch is 16 √ó 16 pixels. As shown, our approach has almost identical performance as the original model (i.e., before unlearning); the generated images on forget set are some random noise. Overall, we outperform all other baseline methods. D.2 DIFFUSION We provide the visualization results under center crop size of 4 √ó 4 patches in Fig. D.7. We also provide more visualization results under center crop size of 8 √ó 8 patches in Fig. D.8. As shown in Fig. D.7 and Fig. D.8, out approach can generate very high quality images on retain set while filling some random noise on the forget set. As a contrast, the other baselines methods struggle on the performance drop on the retain set. RANDOM ENCODER cannot even forget the information on the forget set. 23 Published as a conference paper at ICLR 2024Ground TruthInput Original ModelMAX LOSSNOISY LABELRETAIN LABELRANDOM ENCODEROurs (a) Forget setGround TruthInput Original ModelMAX LOSSNOISY LABELRETAIN LABELRANDOM ENCODEROurs (b) Retain set Figure D.8: Diffusion models: cropping 8 √ó 8 patches at the center of the image, where each patch is 16 √ó 16 pixels. As shown, our approach has almost identical performance as the original model (i.e., before unlearning); the generated images on forget set are some random noise. Overall, we outperform all other baseline methods. D.3 VQ-GAN We provide the visualization results under center crop size of 4 √ó 4 patches in Fig. D.9. We also provide more visualization results under center crop size of 8 √ó 8 patches in Fig. D.10. As shown in Fig. D.9 and Fig. D.10, out approach can generate very high quality images on retain set while fill some random noise on the forget set. RETAIN LABEL cannot even forget the information on the forget set. Moreover, as shown in Fig. D.9, there are two type of fishes; one is in forget set and another one is in retain set (the fourth and fifth rows). Our approach can handle this subtle difference among difference classes. D.4 MAE Random Masking In the original paper (He et al., 2022), MAE primarily focuses on the reconstruction of randomly masked images. Hence, besides the center cropping reported in the main paper, we also report the results under random masking. As shown in Fig. D.11 and Fig. D.12, the performance on the retain set of the 24 Published as a conference paper at ICLR 2024Ground TruthInput Original ModelMAX LOSSNOISY LABELRETAIN LABELRANDOM ENCODEROurs (a) Forget setGround TruthInput Original ModelMAX LOSSNOISY LABELRETAIN LABELRANDOM ENCODEROurs (b) Retain set Figure D.9: VQ-GAN: cropping 4√ó4 patches at the center of the image, where each patch is 16√ó16 pixels. As shown, our approach has almost identical performance as the original model (i.e., before unlearning); the generated images on forget set are some random noise. unlearned model is almost identical as original model. In contrast, there is a significant performance drop on the forget set. E ABLATION STUDY E.1 VARYING CROPPING PATTERN AND RATIO In the main paper, we primarily show the results of uncropping/inpainting tasks. We vary the cropping patterns and use the VQ-GAN to generate the images under these different patterns. We shown the generated images with downward extension in Fig. E.13, upward extension in Fig. E.14, leftward extension in Fig. E.15, rightward extension in Fig. E.16, and outpaint in Fig. E.17, respectively. As shown in these images, our method is robust to different cropping types. As shown in Fig. E.18 and Fig. E.19, we also vary the input cropping ratio and report the FID and CLIP embedding distance. Clearly, our approach is robust to different cropping ratios. 25 Published as a conference paper at ICLR 2024Ground TruthInput Original ModelMAX LOSSNOISY LABELRETAIN LABELRANDOM ENCODEROurs (a) Forget setGround TruthInput Original ModelMAX LOSSNOISY LABELRETAIN LABELRANDOM ENCODEROurs (b) Retain set Figure D.10: VQ-GAN: cropping 8 √ó 8 patches at the center of the image, where each patch is 16 √ó 16 pixels. As shown, our approach has almost identical performance as the original model (i.e., before unlearning); the generated images on forget set are some random noise. Noise type. We compare the performance of Gaussian Noise used in our method with uniform noise for VQ-GAN and MAE. Specifically, we set the noise in Eq. (10) as n ‚àº U[‚àí1, 1] then conduct the unlearning under the same setup. We use the obtained models to generate 500 images for both retain set and forget set. We then compute multiple metrics for different noise types. As shown in Fig. E.20, Gaussian noise achieves better forgetting in the forget set in general (i.e., higher FID, lower IS and lower CLIP on forget sets). These results empirically verify the benefits of using Gaussian Noise, which coincides with our analysis (cf. Lemma 1). E.2 CROSS VALIDATION OF GENERATED IMAGES To further verify the generated images do not have the information from forget set, we conducted the following experiment for VQ-GAN: ‚Ä¢ We first conduct the unlearning for VQ-GAN for ImageNet to obtain the unlearned model, under the same setup mentioned in Section 4. 26 Published as a conference paper at ICLR 2024 20 40 60 Input Masking Ratio(%) 100 150 200 250FID Original: Forget Set Unlearn: Forget Set Original: Retain Set Unlearn: Retain Set (a) MAE: FID 20 40 60 Input Masking Ratio(%) 5 10 15 20Inception Score Original: Forget Set Unlearn: Forget Set Original: Retain Set Unlearn: Retain Set (b) MAE: IS 20 40 60 Input Masking Ratio(%) 0.4 0.5 0.6 0.7 0.8CLIP Embedding Distance Original: Forget Set Unlearn: Forget Set Original: Retain Set Unlearn: Retain Set (c) MAE: CLIP Figure D.11: The quality of reconstructed images given random masked images by MAE under varying random masking ratio; e.g., masking 128 out of 256 patches means 50% cropping ratio. We compare the original model and the unlearned model by our approach. As shown, the performance of these two models on the retain set are almost identical, while the unlearned model has a significant performance drop on the forget set. See Fig. D.4 for some examples of generated images. Table E.4: The comparison of cross validation in Appendix E.2. We first use different models to do the inpainting tasks, i.e., reconstructing the central cropped patches (FIRST reconstructions). Given the FIRST reconstructions as input, we then use the original model (before unlearning) to do the outpainting tasks and get the SECOND reconstructions, i.e., re-generated the outer patches based on these reconstructed central patches from FIRST reconstructions. We then evaluate the quality of these SECOND reconstructed images under various metrics. Lower FID, higher IS, and higher CLIP values indicate higher image quality. FID IS CLIP DR DF DR DF DR DF Original Model 36.14 28.96 27.28 27.95 0.37 0.49 Unlearned Model 36.74 156.68 26.62 7.67 0.37 0.28 ‚Ä¢ Second, given the center-cropped input images (cropping central 8 √ó 8 patches), we then use this unlearned model to generate the images on both forget set and retain set (i.e., image uncrop- ping/inpainting). Here we call them FIRST generated images. ‚Ä¢ Given these FIRST generated images, we only keep the reconstructed central 8 √ó 8 patches (cropping the outer ones) as the new input to the original VQ-GAN (i.e., the model before unlearning) and get the newly generated images (here we call them SECOND generated images). We then evaluate the quality of SECOND generated images for both forget set and retain set and report the results. ‚Ä¢ We also conduct the above process for the original model (i.e., before unlearning) as the base- line/reference. The results are given below: As shown in Table E.4 and Figure E.21, compared to the original model, given the noise (i.e., FIRST generated images on the forget set) from the unlearned model as the input, the SECOND generated images has very low quality in terms of all these three metrics. This means that the noise indeed are not correlated with the real forget images. In contrast, the performance on the retain set is almost the same before and after unlearning. This indicates that our approach indeed preserves the knowledge on the retain set well. 27 Published as a conference paper at ICLR 2024Ground TruthInput Before Unlearning OursMax_LossNoisy_LabelRetain_LabelRandom_EncoderGroundTruthInputBeforeUnlearningAfterUnlearningGroundTruthInputBeforeUnlearningAfterUnlearning (a) Forget setGround TruthInput Before Unlearning OursMax_LossNoisy_LabelRetain_LabelRandom_EncoderGroundTruthInputBeforeUnlearningAfterUnlearningGroundTruthInputBeforeUnlearningAfterUnlearning (b) Retain set Figure D.12: Reconstruction of random masked images by MAE. For a single image, we test 25% masking ratio and 50% masking ratio. 28 Published as a conference paper at ICLR 2024Ground TruthInput Before Unlearning OursMax_LossNoisy_LabelRetain_LabelRandom_EncoderGroundTruthInputBeforeUnlearningAfterUnlearningGroundTruthInputBeforeUnlearningAfterUnlearning (a) Forget setGround TruthInput Before Unlearning OursMax_LossNoisy_LabelRetain_LabelRandom_EncoderGroundTruthInputBeforeUnlearningAfterUnlearningGroundTruthInputBeforeUnlearningAfterUnlearning (b) Retain set Figure E.13: Ablation study: Downward extension by VQ-GAN. We visualize he performance of the original model (before unlearning) and the obtained model by our approach (after unlearning). We show results on both forget set and retain set. 29 Published as a conference paper at ICLR 2024Ground TruthInput Before Unlearning OursMax_LossNoisy_LabelRetain_LabelRandom_EncoderGroundTruthInputBeforeUnlearningAfterUnlearningGroundTruthInputBeforeUnlearningAfterUnlearning (a) Forget setGround TruthInput Before Unlearning OursMax_LossNoisy_LabelRetain_LabelRandom_EncoderGroundTruthInputBeforeUnlearningAfterUnlearningGroundTruthInputBeforeUnlearningAfterUnlearning (b) Retain set Figure E.14: Ablation study: Upward extension by VQ-GAN. We visualize he performance of the original model (before unlearning) and the obtained model by our approach (after unlearning). We show results on both forget set and retain set. 30 Published as a conference paper at ICLR 2024Ground TruthInput Before Unlearning OursMax_LossNoisy_LabelRetain_LabelRandom_EncoderGroundTruthInputBeforeUnlearningAfterUnlearningGroundTruthInputBeforeUnlearningAfterUnlearning (a) Forget setGround TruthInput Before Unlearning OursMax_LossNoisy_LabelRetain_LabelRandom_EncoderGroundTruthInputBeforeUnlearningAfterUnlearningGroundTruthInputBeforeUnlearningAfterUnlearning (b) Retain set Figure E.15: Ablation study: Leftward extension by VQ-GAN. We visualize he performance of the original model (before unlearning) and the obtained model by our approach (after unlearning). We show results on both forget set and retain set. 31 Published as a conference paper at ICLR 2024Ground TruthInput Before Unlearning OursMax_LossNoisy_LabelRetain_LabelRandom_EncoderGroundTruthInputBeforeUnlearningAfterUnlearningGroundTruthInputBeforeUnlearningAfterUnlearning (a) Forget setGround TruthInput Before Unlearning OursMax_LossNoisy_LabelRetain_LabelRandom_EncoderGroundTruthInputBeforeUnlearningAfterUnlearningGroundTruthInputBeforeUnlearningAfterUnlearning (b) Retain set Figure E.16: Ablation study: Rightward extension by VQ-GAN. We visualize he performance of the original model (before unlearning) and the obtained model by our approach (after unlearning). We show results on both forget set and retain set. 32 Published as a conference paper at ICLR 2024Ground TruthInput Before Unlearning OursMax_LossNoisy_LabelRetain_LabelRandom_EncoderGroundTruthInputBeforeUnlearningAfterUnlearningGroundTruthInputBeforeUnlearningAfterUnlearning (a) Forget setGround TruthInput Before Unlearning OursMax_LossNoisy_LabelRetain_LabelRandom_EncoderGroundTruthInputBeforeUnlearningAfterUnlearningGroundTruthInputBeforeUnlearningAfterUnlearning (b) Retain set Figure E.17: Ablation study: Outpaint by VQ-GAN. We visualize he performance of the original model (before unlearning) and the obtained model by our approach (after unlearning). We show results on both forget set and retain set. 33 Published as a conference paper at ICLR 2024 20 40 60 Cropping Ratio(%) 75 100 125 150FID Uncropping/Inpaint Orginal: Forget Set Orginal: Retain Set Unlearn: Forget Set Unlearn: Retain Set 20 40 60 Cropping Ratio(%) 60 80 100 120 140FID Upward Extension Orginal: Forget Set Orginal: Retain Set Unlearn: Forget Set Unlearn: Retain Set 20 40 60 Cropping Ratio(%) 60 80 100FID Downward Extension Orginal: Forget Set Orginal: Retain Set Unlearn: Forget Set Unlearn: Retain Set 20 40 60 Cropping Ratio(%) 60 80 100FID Leftward Extension Orginal: Forget Set Orginal: Retain Set Unlearn: Forget Set Unlearn: Retain Set 20 40 60 Cropping Ratio(%) 60 80 100FID Rightward Extension Orginal: Forget Set Orginal: Retain Set Unlearn: Forget Set Unlearn: Retain Set 20 40 60 Cropping Ratio(%) 20 40 60 80 100FID Outpaint Orginal: Forget Set Orginal: Retain Set Unlearn: Forget Set Unlearn: Retain Set Figure E.18: Ablation study: FID vs. input cropping ratios under different I2I generation tasks. 20 40 60 Cropping Ratio(%) 0.60 0.65 0.70 0.75CLIP Embedding DistanceUncropping/Inpaint Orginal: Forget Set Orginal: Retain Set Unlearn: Forget Set Unlearn: Retain Set 20 40 60 Cropping Ratio(%) 0.60 0.65 0.70 0.75CLIP Embedding DistanceUpward Extension Orginal: Forget Set Orginal: Retain Set Unlearn: Forget Set Unlearn: Retain Set 20 40 60 Cropping Ratio(%) 0.65 0.70 0.75CLIP Embedding DistanceDownward Extension Orginal: Forget Set Orginal: Retain Set Unlearn: Forget Set Unlearn: Retain Set 20 40 60 Cropping Ratio(%) 0.60 0.65 0.70 0.75CLIP Embedding DistanceLeftward Extension Orginal: Forget Set Orginal: Retain Set Unlearn: Forget Set Unlearn: Retain Set 20 40 60 Cropping Ratio(%) 0.60 0.65 0.70 0.75CLIP Embedding DistanceRightward Extension Orginal: Forget Set Orginal: Retain Set Unlearn: Forget Set Unlearn: Retain Set 20 40 60 Cropping Ratio(%) 0.6 0.7 0.8CLIP Embedding DistanceOutpaint Orginal: Forget Set Orginal: Retain Set Unlearn: Forget Set Unlearn: Retain Set Figure E.19: Ablation study: CLIP embedding distance vs. input cropping ratios under different I2I generation tasks. 34 Published as a conference paper at ICLR 2024 0 20 40 Cropping Ratio(%) 100 150 200FID Uniform: Forget Set Gaussian: Forget Set Uniform: Retain Set Gaussian: Retain Set (a) VQ-GAN: FID 0 10 20 30 40 Cropping Ratio(%) 6 8 10 12Inception Score Uniform: Forget Set Gaussian: Forget Set Uniform: Retain Set Gaussian: Retain Set (b) VQ-GAN: IS 0 20 40 Cropping Ratio(%) 0.4 0.5 0.6 0.7CLIP Embedding Distance Uniform: Forget Set Gaussian: Forget Set Uniform: Retain Set Gaussian: Retain Set (c) VQ-GAN: CLIP 0 10 20 30 40 Cropping Ratio(%) 50 100 150 200FID Uniform: Forget Set Gaussian: Forget Set Uniform: Retain Set Gaussian: Retain Set (d) MAE: FID 0 10 20 30 40 Cropping Ratio(%) 5 10 15 20 25Inception Score Uniform: Forget Set Gaussian: Forget Set Uniform: Retain Set Gaussian: Retain Set (e) MAE: IS 0 10 20 30 40 Cropping Ratio(%) 0.7 0.8 0.9 1.0CLIP Embedding DistanceUniform: Forget Set Gaussian: Forget Set Uniform: Retain Set Gaussian: Retain Set (f) MAE: CLIP Figure E.20: Ablation study of noise type. We test the performance under varying ratios of central cropping; e.g., cropping 8 √ó 8 out of 256 patches means a 25% cropping ratio. For VQ-GAN and MAE, Gaussian noise achieves better forgetting in the forget set in general (i.e., it achieves higher FID, lower IS and lower CLIP on forget set).GroundTruthOriginal ModelUnlearned Model (a) Forget SetGroundTruthOriginal ModelUnlearned Model (b) Retain Set Figure E.21: Visualization of cross validation in Appendix E.2. We first use different models to do the inpainting tasks, i.e., reconstructing the central cropped patches (FIRST reconstructions). Given the FIRST reconstructions as input, we then use the original model (before unlearning) to do the outpainting tasks and get the SECOND reconstructions, i.e., re-generated the outer patches based on these reconstructed central patches from FIRST reconstructions. We then evaluate the quality of these SECOND reconstructed images under various metrics. 35","libVersion":"0.3.2","langs":""}